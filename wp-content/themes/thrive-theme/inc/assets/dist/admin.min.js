/*! Thrive Themes 2020-09-26
* http://www.thrivethemes.com/
* Copyright (c) 2020 Thrive Themes */

"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function ownKeys(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(i,!0).forEach(function(e){_defineProperty(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(l){var p,u,n,m,f,a={".js":[],".json":[],".css":[],".html":[]},c="function"==typeof require?require:null;return m=function(e){var t=new Error("Could not find module '"+e+"'");return t.code="MODULE_NOT_FOUND",t},f=function(e,t,i){var s,n;if("function"==typeof e[t+i])return t+i;for(s=0;n=a[i][s];++s)if("function"==typeof e[t+n])return t+n;return null},p=function(e,t,i,s,n,a){var o,r,l,c,d,h;for("."!==(o=(i=i.split("/")).pop())&&".."!==o||(i.push(o),o="");null!=(r=i.shift());)if(r&&"."!==r&&(".."===r?(e=t.pop(),a=a.slice(0,a.lastIndexOf("/"))):(t.push(e),e=e[r],a+="/"+r),!e))throw m(s);if(o&&"function"!=typeof e[o]&&((h=f(e,o,".js"))||(h=f(e,o,".json")),h||(h=f(e,o,".css")),h||(h=f(e,o,".html")),h?o=h:2!==n&&"object"===_typeof(e[o])&&(t.push(e),e=e[o],a+="/"+o,o="")),!o)return 1!==n&&e[":mainpath:"]?p(e,t,e[":mainpath:"],s,1,a):p(e,t,"index",s,2,a);if(!(d=e[o]))throw m(s);return d.hasOwnProperty("module")?d.module.exports:(l={},d.module=c={exports:l,id:a+"/"+o},d.call(l,l,c,u(e,t,a)),c.exports)},n=function(e,t,i,s){var n,a=i,o=i.charAt(0),r=0;if("/"===o){if(a=a.slice(1),!(e=l["/"])){if(c)return c(i);throw m(i)}s="/",t=[]}else if("."!==o){if(n=a.split("/",1)[0],!(e=l[n])){if(c)return c(i);throw m(i)}s=n,t=[],(a=a.slice(n.length+1))||(r=(a=e[":mainpath:"])?1:(a="index",2))}return p(e,t,a,i,r,s)},(u=function(t,i,s){return function(e){return n(t,[].concat(i),e,s)}})(l,[],"")}({workspace:{inc:{assets:{js:{admin:{collections:{"base.js":function(e,t,i){t.exports=Backbone.Collection.extend({model:i("../models/base")})},"plugins.js":function(e,t,i){var s=i("./base").extend({model:i("../models/plugin"),activePlugins:function(){return this.where({active:!0})},getLatestActivePlugin:function(){var e=this.activePlugins();return e.length?e.pop():null},comparator:function(e){return e.get("configured")?0:1}});t.exports=s},"skins.js":function(e,t,i){var s=i("./base").extend({model:i("../models/skin"),initialize:function(e){e.forEach(function(e){var t=jQuery.parseHTML(e.name);e.name=t?t[0].textContent:e.name,delete e.parent})},comparator:function(e,t){return t.get("term_id")-e.get("term_id")},get_active_skin:function(){var t;return this.models.forEach(function(e){e.is_active()&&(t=e)}),t},byName:function(t){var e=this.filter(function(e){return-1!==e.get("name").indexOf(t)});return new s(e)}});t.exports=s},"templates.js":function(e,t,i){var s=i("./base").extend({model:i("../models/template"),hasModel:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";return 0<this.filter(function(e){return e.meta("primary_template")===t&&e.meta("secondary_template")===i&&e.meta("variable_template")===s}).length},postTypeHasTemplate:function(t){return 0<this.filter(function(e){return e.meta("secondary_template")===t}).length},generalArchiveTemplateExists:function(){return TTD.objects.collections.templates.hasModel("archive")},comparator:function(e){return e.id},filterItems:function(a){var o=this;return this.filter(function(e){var t=o.filterByTemplateType(e),i=e.singleOrList(a),s=o.checkPostType(e),n=e.checkName(TTD.objects.models.filter.get("name"));return t&&i&&s&&n})},filterByTemplateType:function(e){var t=!0;switch(TTD.objects.models.filter.get("template")){case"core":t=e.isCore();break;case"archive":t=e.isArchive();break;case"homepage":t=e.isHomepage()}return t},checkPostType:function(e){var t=TTD.objects.models.filter.get("post_type"),i=e.secondary(),s=!0;switch(t){case"all":var n=_.filter(TTD.CONST.content_types,function(e){return"post"!==e.key&&"page"!==e.key});s=void 0!==_.findKey(n,function(e){return e.key===i});break;case TTD.CONST.woocommerce.key:s=e.isWoo();break;case"":break;default:s="blog"===i?"post"===t:t===i}return s},modelInItemsFiltered:function(t){var e=this.filterItems(t.getType());return-1!==_.findIndex(e,function(e){return e.get("ID")===t.get("ID")})},prepareTemplatesForSelect:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:jQuery.noop,t=1<arguments.length?arguments[1]:void 0,i=this.filter(e),s=i.find(function(e){return e.isDefault()&&e.primary()===t.primary_template&&e.secondary()===t.secondary_template&&("post"!==t.secondary_template||e.format()===t.format)});return s||(s=i.find(function(e){return e.isDefault()&&e.primary()===t.primary_template&&e.secondary()===t.secondary_template}))||(s={id:"default"}),(i=i.map(function(e){return{key:e.get("ID"),name:e.name(),secondary:e.secondary(),inheritFrom:e.get("ID")===s.id}})).unshift({key:"default",name:"Start from scratch",inheritFrom:"default"===s.id}),i},build:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:TTD.CONST.templates;return this.reset(),e.forEach(function(e){return t.add(TTD.utils.templateModelFactory(e))}),this}});t.exports=(new s).build()},"typography.js":function(e,t,i){var s=i("./base");t.exports=s.extend({model:i("../models/typography"),comparator:function(e,t){return t.get("ID")-e.get("ID")}})}},models:{"base.js":function(e,t,i){t.exports=Backbone.Model.extend({sync:function(e,t,i){(i=i||{}).cache=!1;var s=i.beforeSend;return i.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",TTD.CONST.nonce),"function"==typeof s)return s.apply(this,arguments)},Backbone.sync(e,t,i)},deepGet:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.attributes,s=Array.isArray(e)?e:e.split("."),n=i[s.shift()];void 0!==n&&s.length;){var a=s.shift();if(void 0===n[a])return t;n=n[a]}return void 0===n?t:n},reset:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.clear({silent:e}),this.set("function"==typeof this.defaults?this.defaults():_objectSpread({},this.defaults))},getMultipleAttributes:function(e){var t=this,i={};return _.each(e,function(e){i[e]=t.get(e)}),i}})},"filter.js":function(e,t,i){t.exports=i("./base").extend({defaults:function(){return{title:"core",type:"",template:"core",post_type:"",name:"",counter:0}},setOptions:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.set(e),t||this.trigger("theme_dash:filter")}})},"homepage-template.js":function(e,t,i){var s=i("./template");t.exports=s.extend({hasThumbnail:function(){return!!this.isLandingPage()||s.prototype.hasThumbnail.call(this)},getThumbnailUrl:function(){return this.isLandingPage()?TTD.CONST.theme_url+"/inc/assets/images/lp-icon.png":s.prototype.getThumbnailUrl.call(this)},title:function(){return this.isLandingPage()?TTD.CONST.options.page.post_title:this.get("post_title")},icon:function(){var e="".concat(this.primary(),"-").concat(this.secondary());return"blog"===this.secondary()&&(e="archive-general-template"),'<svg><use xlink:href="#ttd-'.concat(e,'"></use></svg>')},isLandingPage:function(){return"page"===this.secondary()&&TTD.utils.isHomeLandingPage()},inheritsTemplate:function(){return 0===this.get("ID")},isCore:function(){return this.isDefault()},label:function(){return TTD.utils.homepageType()===this.secondary()?'<svg><use xlink:href="#ttd-home-page"></use></svg>Active Homepage':"Default ".concat(TTD.utils.capitalize(this.secondary()))},getContentType:function(){return this.isLandingPage()?"Thrive Landing Page":this.isList()?"Blog":"Homepage"}})},"logo.js":function(e,t,i){var s=i("./base");t.exports=s.extend({defaults:function(){return{type:"",attachment_id:0,src:""}},initialize:function(e){e.attachment_id=TTD.CONST.branding.logo_data[e.type].attachment_id,e.src=TTD.CONST.branding.logo_data[e.type].src,this.set(e,{silent:!0})},getDisplayName:function(){return TTD.utils.capitalize(this.get("type"))+" Version"},getPlaceholder:function(){return TTD.CONST.branding.logo_data[this.get("type")].placeholder},fetchSourceForAttachmentId:function(){var i=this,s=this.get("attachment_id");if(""!==s&&0!==parseInt(s)){var e=this.getLogoCache(s);void 0===e?jQuery.ajax({url:TTD.CONST.routes.images+"/"+s,type:"get",headers:{"X-WP-Nonce":TTD.CONST.nonce}}).success(function(e){var t=e||i.getPlaceholder();i.set("src",t),i.setLogoCache(s,t)}).error(function(){TTD.utils.message("Error retrieving the logo.","error")}):this.set("src",e)}else this.set("src",this.getPlaceholder())},saveLogoAttachmentId:function(e,t,i){0!==e&&this.setLogoCache(e,t),this.set("src",t),TTD.CONST.branding.logo_data[this.get("type")].attachment_id=e,TTD.CONST.branding.logo_data[this.get("type")].src=t;var s=TTD.CONST.branding.logo_data[this.get("type")].logo_id;jQuery.ajax({url:TTD.CONST.routes.logo+"/"+s,type:"PUT",headers:{"X-WP-Nonce":TTD.CONST.nonce},data:{attachment_id:e}}).success(function(e){"function"==typeof i&&i(e)}).error(function(){TTD.utils.message("Error retrieving the logo.","error")})},shouldHideReset:function(){var e=!this.get("src"),t=this.get("src")===this.getPlaceholder();return e||t},getLogoCache:function(e){return TTD.objects.collections.logo_sources&&TTD.objects.collections.logo_sources[e]},setLogoCache:function(e,t){TTD.objects.collections.logo_sources=TTD.objects.collections.logo_sources||{},TTD.objects.collections.logo_sources[e]=t}})},"media-library.js":function(e,t,i){var s=function(){function i(e){_classCallCheck(this,i);var t=void 0!==e.gallery_args?e.gallery_args:{};t=Object.assign({title:"Choose an image",button:{text:"Select"},multiple:!1,frame:"select",library:{type:"image"}},t),this.instance=wp.media(t),this.add_callbacks(e.callbacks)}return _createClass(i,[{key:"add_callbacks",value:function(t){var i=this;this.instance.on("open",function(){"function"==typeof t.on_open&&t.on_open()}),this.instance.on("select",function(){if("function"==typeof t.on_select){var e=i.instance.state().get("selection").first().toJSON();t.on_select(e)}})}},{key:"open",value:function(){this.instance.open()}},{key:"get_instance",value:function(){return this.instance}}]),i}();t.exports=s},"plugin.js":function(e,t,i){var s;jQuery,s=i("./base"),t.exports=s.extend({pluginAction:function(i,s,n,a){var o=this;return new Promise(function(e,t){TTD.utils.sendApiRequest("plugins/"+i,_objectSpread({},o.getMultipleAttributes(s),{},a)).done(function(t){if(!_.isEmpty(n)){var i={};_.each(n,function(e){i[e]=t[e]}),o.set(i)}e(t)}).error(function(e){e.responseJSON&&(TTD.utils.message(e.responseJSON.message,"error"),t(e.responseJSON.message))})})}})},"skin.js":function(e,t,i){var s=i("./base");t.exports=s.extend({urlRoot:TTD.CONST.routes.skins,idAttribute:"term_id",is_active:function(){return"1"===this.get("is_active")},set_active:function(){this.set("is_active",1)},parse:function(e){return!e.id&&e.term_id&&(e.id=e.term_id),void 0!==e.parent&&delete e.parent,e},make_active:function(){this.set_active(),TTD.utils.loading(),this.save({},{wait:!0,success:function(){return setTimeout(function(){return location.reload()},1e3)},error:function(){return TTD.utils.message("There was an error when activation the theme","error")}})}})},"template.js":function(e,t,i){var s=i("./base");t.exports=s.extend({urlRoot:TTD.CONST.routes.templates,idAttribute:"ID",defaults:function(){return{post_title:"",meta_input:{primary_template:"",secondary_template:"",variable_template:"",header:"",footer:"",format:"standard"},thumbnail:"",just_added:0,edit_url:"",preview_url:""}},meta:function(e,t){var i=this.get("meta_input");return void 0!==t&&(i[e]=t,this.set("meta_input",i)),i[e]},title:function(){return this.get("post_title")},primary:function(){return this.meta("primary_template")},secondary:function(){return this.meta("secondary_template")},variable:function(){return this.meta("variable_template")},format:function(){var e=this.meta("format");return void 0===e||0===e.length?"standard":e},getContentType:function(){var e;return 0===(e=this.is404()?"404":this.isSearch()?"Search":this.secondary()).length&&(e=this.isList()?"Archive":"Post"),e},icon:function(){var e=this.primary(),t=this.secondary(),i=["ttd"];if(this.isWoo())i.push("woo");else if(this.isSingular())switch(i.push("singular"),t){case"post":i.push("post",this.format());break;case"page":i.push("page")}else"archive"===e?i.push("archive",t?"custom":"general","template"):(i.push(e),t.length&&i.push(t));return'<svg><use xlink:href="#'.concat(i.join("-"),'"></use></svg>')},name:function(){var e=this.title();if(!e){var t=this.primary(),i=this.secondary(),s=this.variable();switch(t){case"singular":e="post"===i?(e=TTD.utils.capitalize(this.format()),(e||"Standard")+" Post"):TTD.utils.capitalize(i);break;case"archive":if(0<i.length){var n=TTD.CONST.archive_types[i];e=n.name,0<s.length&&(e+=" "+n.sub[s]),e+=" Archive"}else e="All Archives";break;default:e=TTD.utils.capitalize(t)}}return e.replace("Thrive ","")},isSingular:function(){return"singular"===this.primary()},isDefault:function(){return 1===parseInt(this.meta("default"))},isPostFormat:function(){return this.isSingular()&&"standard"!==this.format()},isPageTemplate:function(){return this.isSingular()&&"page"===this.secondary()&&!this.isDefault()},isBlog:function(){return"blog"===this.primary()},isSearch:function(){return"search"===this.primary()},is404:function(){return"error404"===this.primary()},isProduct:function(){return"product"===this.secondary()},isHomepage:function(){return"home"===this.primary()},isGeneralArchive:function(){return"archive"===this.primary()&&""===this.secondary()},isCustomArchive:function(){return"archive"===this.primary()&&this.secondary()},canDuplicate:function(){return!0},isFallback:function(){return!!this.get("isFallback")},isList:function(){return this.isArchive()||this.isSearch()||this.isHomepage()&&"blog"===this.secondary()},singleOrList:function(e){var t=this.isList();return"single"===e?!t:t},checkName:function(e){return!e.trim().length||this.title().trim().toLowerCase().includes(e.toLowerCase())},isCore:function(){return["singular","archive","search","error404","blog"].includes(this.primary())&&(["post","page","product"].includes(this.secondary())||""===this.secondary())&&this.isDefault()},isArchive:function(){return"archive"===this.primary()},getType:function(){return this.isList()?"list":"single"},getLayoutName:function(){return this.get("layout")},getThumbnailUrl:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return this.get("thumbnail").url+(e?"?_=".concat((new Date).getTime()):"")},getThumbnailCss:function(){return"background-image:linear-gradient(\n\t\t\t\t\t\t\t\t\t\t\t\t\trgba(255, 255, 255, 0) 0%, \n\t\t\t\t\t\t\t\t\t\t\t\t    rgba(255, 255, 255, 0) 80%,\n\t\t\t\t\t\t\t\t\t\t\t\t\trgb(255, 255, 255) 100%), \n\t\t\t\t\t\t\t\t\t\t\t\t\turl( ".concat(this.getThumbnailUrl()," );")},hasThumbnail:function(){var e=this.get("thumbnail");return!_.isEmpty(e)&&!_.isEmpty(e.url)},getOrder:function(){var e=0;return this.isDefault()?e+=3:e-=1,this.isHomepage()?e+=4:this.isSingular()?("post"===this.secondary()&&"standard"===this.format()&&(e+=2),this.isProduct()&&(e+=1),e+=1):this.isGeneralArchive()?e+=2:this.isSearch&&(e+=1),-1*e},getDefaultLabel:function(){var e=this.secondary(),t=this.variable(),i=this.primary();if(this.isSingular())i=e,this.isPostFormat()?i="".concat(this.format()," ").concat(i):this.isWoo()&&(i=" ".concat(TTD.CONST.woocommerce.label," ").concat(i));else if(this.isProduct())i=" ".concat(TTD.CONST.woocommerce.label," ").concat(TTD.CONST.woocommerce.shop_label);else if(e&&this.isCustomArchive()){var s=_.findWhere(TTD.CONST.list_templates,{key:"archive"});void 0!==s&&s.secondary&&s.secondary[e]&&(i=s.secondary[e].name)}if(t)try{i="".concat(i,' "').concat(TTD.CONST.list_templates.find(function(e){return"archive"===e.key}).secondary[e].variable[t]||"",'"')}catch(e){console.warn(e)}return"Default ".concat(i)},isWoo:function(){return TTD.CONST.woocommerce.is_active&&TTD.CONST.woocommerce.templates.includes(this.meta("secondary_template"))},isJustAdded:function(){return this.get("just_added")}})},"typography.js":function(e,t,i){var s=i("./base");t.exports=s.extend({urlRoot:TTD.CONST.routes.typography,idAttribute:"ID",defaults:function(){return{post_title:"",meta_input:{default:0,style:""},edit_url:"",preview_url:""}},is_active:function(){return this.meta("default")},meta:function(e,t){var i=this.get("meta_input");return void 0!==t&&(i[e]=t,this.set("meta_input",i)),i[e]},getPreviewUrl:function(){return this.get("preview_url")+"&admin_preview_id=".concat(this.get("ID"))}})},wizard:{"const.js":function(e,t,i){t.exports={STEPS:TTD.CONST.wizard.structure.steps.map(function(e){return e.comingSoon=!TTD.CONST.wizard.active_steps.includes(e.id),e}),SECTIONS:TTD.CONST.wizard.structure.sections}}},"wizard.js":function(e,t,i){var s,n=i("./wizard/const"),d=n.STEPS,a=n.SECTIONS,o=i("./base").extend({promises:{},defaults:function(){var t={};return Object.values(d).forEach(function(e){return t[e.id]=null}),t.template_instances={},t},load:function(i){var s=this;return this.promises[i]||(this.promises[i]=new Promise(function(t,e){if(null!==s.attributes[i])return t(s.attributes[i]);s.fetch(i).done(function(e){e&&e.data&&(s.set(i,Object.values(e.data)),t(e.data))}).error(e)})),this.promises[i].finally(function(){delete s.promises[i]}),this.promises[i]},updateTemplateId:function(e,t,i){var s=this.get(e);if(s){var n=s.find(function(e){return String(e.id)===String(t)});n&&(n.id=i)}return this},loadTemplate:function(e,s,n){var a=this,o=e+"--"+s,r=this.get("template_instances");return new Promise(function(i,t){if(r[o])return i(r[o]);a.fetchInstance(e,s,n).done(function(e){var t=e.data||e;r[o]=t,a.set({instances:r}),i(t)}).error(function(e){return t(e)})})},clearCache:function(t){var i=this.get("template_instances");Object.keys(i).forEach(function(e){e.startsWith(t+"--")&&delete i[e]})},fetch:function(t){var i=this;return jQuery.ajax({url:"".concat(TTD.CONST.routes.wizard,"/templates"),data:{type:t},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).error(function(e){e.responseJSON&&(TTD.utils.message(e.responseJSON.message,"error"),i.attributes[t]=null)})},fetchInstance:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"".concat(TTD.CONST.routes.wizard,"/templates/").concat(t);return jQuery.ajax({url:i,data:{type:e},headers:{"X-WP-Nonce":TTD.CONST.nonce}})},indexOf:function(e,t){return this.get(e)?this.get(e).findIndex(function(e){return String(e.id)===t}):-1},count:function(e){return this.get(e)?this.get(e).length:0},getNextTemplateId:function(e,t){return(this.get(e)[this.indexOf(e,t)+1]||{id:""}).id},getPrevTemplateId:function(e,t){return(this.get(e)[this.indexOf(e,t)-1]||{id:""}).id},getTemplate:function(e,t){var i=this.indexOf(e,t);return-1<i?this.get(e)[i]:null}}),r=i("./base").extend({defaults:function(){return{step:"splash",type:""}},__savedStepData:null,initialize:function(){var i=this;s.on("step-change",function(e,t){e.id!==t.id&&("homepage"===e.id?i.saveWizardData():"homepage"===t.id&&i.restoreWizardData(),i.reset())})},saveWizardData:function(){s.isStepCompleted("homepage")&&(this.__savedStepData=_objectSpread({},s.deepGet("settings.homepage")))},restoreWizardData:function(){this.__savedStepData&&s.isStepCompleted("homepage")&&s.setStepData(this.__savedStepData,!0,!0,"homepage")},clearWizardData:function(){this.__savedStepData=null},isSplash:function(){return!s.isStepCompleted()&&"splash"===this.get("step")},reset:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.clear({silent:!0}),this.set(_objectSpread({},this.defaults(),{},this.__savedStepData||s.deepGet("settings.homepage")),{silent:e})},data:function(){var e={title:"Choose a Homepage",canContinue:!1,hasTemplateSelector:!(this.isSplash()||!this.get("type")),hasTemplateDropdown:"blog"!==this.get("type"),popupMessage:"",saveData:{type:this.get("type")}};if(this.isSplash())return e;switch(this.get("type")){case"page":e.title="Homepage - Choose an existing page on your site",e.canContinue=!!this.get("page_id"),e.saveData.page_id=this.get("page_id"),e.saveData.page_title=this.get("page_title"),e.saveData.page_url=this.get("page_url"),e.saveData.is_landing_page=this.get("is_landing_page");break;case"blog":e.title="Homepage - Display your Blog as homepage",e.canContinue=!0,e.hasTemplateSelector=s.hasStepChanges();break;case"template":e.title="Homepage - Choose one of our Ready Made Templates",e.canContinue=s.deepGet("settings.homepage.template_id"),e.popupMessage=s.isStepCompleted()?"You can change the <strong>Homepage Template</strong> from the top dropdown":"You can change the <strong>Homepage Template</strong> from the top dropdown or<br>by pressing the arrow keys &lt; &gt;<br>When you are done press the <strong>Choose and Continue</strong> button.",e.saveData.template_id=s.deepGet("settings.homepage.template_id")}return e},getFrameURL:function(){var e=TTD.CONST.wizard.urls.home,t={step:"homepage",type:this.isSplash()?"":this.get("type")};return"page"===t.type?t.page_id=this.get("page_id"):"template"===t.type&&(t.template_id=this.get("template_id"),e=TTD.CONST.wizard.urls.draft_homepage),c(e=new URL(e),t)},getPreviewTemplateId:function(){var e="";return e="page"===this.get("type")?this.get("page_id"):this.get("template_id"),String(e||"")}}),l=i("./base").extend({homepageState:null,sections:a,templates:new o(TTD.CONST.wizard.templates),url:TTD.CONST.routes.wizard,iframeData:{headerHeight:"",footerHeight:"",templateId:"",scrollWidth:"",nextPage:{},prevPage:{}},isNew:function(){return!0},defaults:function(){return{activeIndex:-1,active:"",done:[],settings:{}}},initialize:function(e){e.active&&(-1===this.indexOf(e.active)?this.set("active",""):this.loadStepTemplates()),window.TTD.objects.templatesStore=this.templates},getSteps:function(t){var i=this;return d.filter(function(e){return e.section===t}).map(function(e){return e.active=i.get("active")===e.id,e.done=i.get("done").includes(e.id),e.disabled=!i.canAccessStep(e.id),e})},loadStepTemplates:function(){var t=this,e=this.get("active")&&!["logo","menu"].includes(this.get("active"))?this.templates.load(this.get("active")):new Promise(function(e){return e([])});return e.then(function(e){t.trigger("templates-loaded",e)}),e},_id:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return e?"string"==typeof e?e:e.id:""},indexOf:function(t){return t=this._id(t),_.findIndex(d,function(e){return e.id===t})},canAccessStep:function(e){return e=this._id(e),!0},markComplete:function(e){Array.isArray(e)||(e=[e]);var t=new Set(this.get("done").concat(e));return this.set({done:Array.from(t).map(this._id)},{silent:!0}),this},getStep:function(e){return d[e]},gotoStep:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"header";if(e=this._id(e),this.canAccessStep(e)&&e!==this.get("active")){var t=this.getCurrentStep();this.set({active:e,activeIndex:this.indexOf(e)}),this.triggerStepChange(t)}return this},triggerStepChange:function(e){e&&e.id===this.get("active")||this.loadStepTemplates(),e||(e=d[this.get("activeIndex")]),this.trigger("step-change",d[this.get("activeIndex")],e)},getCurrentStep:function(){return d[this.get("activeIndex")]},getStepKey:function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getCurrentStep())[e]},getOriginalStepData:function(e){return this.deepGet("settings.".concat(this.get("active"),".").concat(e),null,TTD.CONST.wizardOriginal)},hasActiveStep:function(){return 0<=this.get("activeIndex")&&d[this.get("activeIndex")]},previous:function(){for(var e=this.get("activeIndex")-1;d[e]&&d[e].comingSoon;)e--;return d[e]&&this.gotoStep(d[e].id),this},hasNextStep:function(){return-1!==this.getNextAvailableStepIndex()},hasPreviousStep:function(){return-1!==this.getPrevAvailableStepIndex()},next:function(){if(this.isFinished(!1))return this.set({active:"",activeIndex:-1}),this.trigger("finished"),this;var e=this.getNextAvailableStep();return e&&this.gotoStep(e.id),this},getStepBaseURL:function(){var e=this.getCurrentStep(),t="post",i=this._id(e);switch(i){case"blog":t="blog";break;case"page":t="page";break;case"product":case"shop":case"cart":case"checkout":t=i}return TTD.CONST.wizard.urls[t]},getFrameURL:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.getCurrentStep()||this.getNextAvailableStep(),i=new URL(this.getStepBaseURL());return this.isFinished()||!t?(i.searchParams.append("ttb-wizard[step]","__welcome"),String(i)):"homepage"===t.id?this.isStepCompleted()&&!this.hasStepChanges()?TTD.utils.addUrlParam(TTD.CONST.wizard.urls.home,{"ttb-wizard[step]":"homepage-done"}):this.homepageState.getFrameURL():c(i,e=_objectSpread({step:t.id},this.deepGet("settings.".concat(t.id),{}),{},e))},isStarted:function(){return 0<this.get("done").length||this.get("active")},isFinished:function(){return!(!!(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])&&this.get("active"))&&this.get("done").length>=d.filter(function(e){return!e.comingSoon}).length},getNextAvailableStep:function(){return d[this.getNextAvailableStepIndex()]||null},getNextAvailableStepIndex:function(){var t=this,e=d.map(function(e,t){return t}).filter(function(e){return!d[e].comingSoon&&!t.get("done").includes(d[e].id)});if(0===e.length)return-1;var i=e[0],s=Number(this.get("activeIndex"));return e.some(function(e){if(s<e)return i=e,!0}),i!==s?i:-1},getPrevAvailableStepIndex:function(){var t=this,e=d.map(function(e,t){return t}).filter(function(e){return!d[e].comingSoon&&!t.get("done").includes(d[e].id)}).reverse();if(0===e.length)return-1;var i=e[0],s=Number(this.get("activeIndex"));return e.some(function(e){if(e<s)return i=e,!0}),i!==s?i:-1},start:function(){return this.gotoStep(this.getNextAvailableStep())},setStepData:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.get("active"),n=this.get("settings");return i&&delete n[s],n[s]=_objectSpread({},n[s]||{},{},e),this.set({settings:n},{silent:t}),this},completeStep:function(){var s=this,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],a=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=this.get("active");TTD.utils.do_action("wizard.model.complete.".concat(this.get("active")),this,n),TTD.CONST.wizardOriginal.settings=TTD.CONST.wizardOriginal.settings||{},TTD.CONST.wizardOriginal.settings[o]=jQuery.extend(!0,{},this.deepGet("settings.".concat(o)));var r=this.getNextAvailableStep();"logo"===o&&(this.templates.clearCache("header"),this.templates.clearCache("footer"),this.templates.clearCache("woo_header"),this.templates.clearCache("woo_footer")),this.trigger("ajax-send"),this.markComplete(o),!a&&n&&this.next();var e=this.attributes,l=e.active,c=e.activeIndex;return this.save(void 0,{beforeSend:function(e,t){var i=new URL(t.url);i.searchParams.append("step",o),i.searchParams.append("next",r?r.id:""),i.searchParams.append("nextIndex",d.indexOf(r)),t.url=i.toString()}}).done(function(e){var t=e.success;delete e.success,TTD.CONST.wizard=_objectSpread({},TTD.CONST.wizard,{},e);var i=s.get("settings");s.clear({silent:!0}),s.set(_objectSpread({done:[]},TTD.CONST.wizard.data,{},{settings:i},{active:l,activeIndex:c}),{silent:!0}),a||n||s.next(),s.trigger("complete-step-done",e,t),e.message&&TTD.utils.message(e.message,"info")}).always(function(){s.trigger("ajax-done")})},canContinue:function(){return TTD.utils.apply_filters("wizard.can_continue",this.getPreviewTemplateId(),this)},getPreviewTemplateId:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.get("active");return"homepage"===e?this.homepageState.getPreviewTemplateId():String(this.deepGet("settings.".concat(e,".template_id"),""))},getAdjacentTemplateId:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"next";return this.templates["next"===e?"getNextTemplateId":"getPrevTemplateId"](this.get("active"),this.getPreviewTemplateId())},getPreviewTemplateTitle:function(){var e=this.templates.getTemplate(this.get("active"),this.getPreviewTemplateId()),t=this.getCurrentStep();return TTD.utils.apply_filters("wizard.preview_template_title",e?e.post_title:"")||t&&t.selector&&t.selector.label},hasPrevTemplate:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.get("active");return"homepage"===e&&"page"===this.homepageState.get("type")?!!this.iframeData.prevPage:0<this.templates.indexOf(e,this.getPreviewTemplateId(e))},hasNextTemplate:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.get("active");return"homepage"===e&&"page"===this.homepageState.get("type")?!!this.iframeData.nextPage:this.templates.indexOf(e,this.getPreviewTemplateId(e))<this.templates.count(e)-1},selectTemplate:function(t){var e,i=this,s={template_id:t};return"iframe"===this.getStepKey("previewMode")?(this.setStepData(s),"homepage"===this.get("active")&&this.homepageState.set(s,{silent:!0}),e=new Promise(function(e){e({id:t})}),this.triggerStepChange()):e=this.templates.loadTemplate(this.get("active"),t),e.finally(function(){i.setStepData(s),i.trigger("template-selected")}),e},getTemplateDefaultIcon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getCurrentStep(),t="";switch(this._id(e)){case"post":t="singular-post-standard";break;case"blog":t="archive-general-template";break;case"homepage":case"page":t="singular-page"}return t?TTD.utils.icon(t):""},hasTopBar:function(){return this.getCurrentStep()&&this.getStepKey("hasTopMenu")},hasTemplateSelector:function(){return!!this.get("active")&&("homepage"===this.get("active")?this.homepageState.data().hasTemplateSelector:!!this.getStepKey("selector"))},hasSelectorDropdown:function(){return"homepage"!==this.get("active")||this.homepageState.data().hasTemplateDropdown},getContinueLabel:function(){var e=this.isFinished(!1);return"homepage"===this.get("active")&&"blog"===this.homepageState.get("type")?e?"Choose":"Continue":e?"Choose":"Choose and Continue"},isStepCompleted:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.get("active");return this.get("done").includes(this._id(e))},getPopupMessage:function(){if(this.hasActiveStep()){var e=this.getCurrentStep();return"homepage"===e.id?this.homepageState.data().popupMessage:(this.isStepCompleted()?e.completedPopupMessage:e.popupMessage)||""}},getStepTitle:function(){var e=this.getCurrentStep();return e?this.isStepCompleted()?e.sidebarLabel:"homepage"===e.id?this.homepageState.data().title:e.title:""},hasStepChanges:function(){var t=this,e=this.get("active");if(!e)return!1;if("homepage"===e){var i=this.homepageState,s=i.get("type");return s!==this.getOriginalStepData("type")||"page"===s&&String(i.get("page_id"))!==String(this.getOriginalStepData("page_id"))||"template"===s&&String(i.get("template_id"))!==String(this.getOriginalStepData("template_id"))}var n=this.deepGet("settings.".concat(e));return Object.keys(n).some(function(e){return String(t.getOriginalStepData(e))!==String(n[e])})},hasPreviousStepLink:function(){return!this.isStepCompleted()&&0<this.get("activeIndex")}});function c(i,e){return i instanceof URL||(i=new URL(i)),_.each(e,function(e,t){i.searchParams.append("ttb-wizard[".concat(t,"]"),e||"")}),i.searchParams.append("_preview","1"),String(i)}(s=new l(_.isEmpty(ttd_admin_localize.wizard.data)?{}:ttd_admin_localize.wizard.data)).homepageState=new r,TTD.CONST.wizardOriginal=jQuery.extend(!0,{},ttd_admin_localize.wizard.data),t.exports=s}},"router.js":function(e,t,i){_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/<#=([\s\S]+?)#>/g,escape:/<#-([\s\S]+?)#>/g};var s,n=window.TTD={CONST:ttd_admin_localize,objects:{collections:{},modals:{},media:{},models:{}},Views:{}};s=jQuery,n.DEBUG_MODE=!!parseInt(n.CONST.debug),n.utils=i("./utils"),n.Elements={$body:s("body"),$document:s(document),$window:s(window)},n.objects.collections.templates=i("./collections/templates"),n.Elements.$body.addClass("folded"),n.Router=new(Backbone.Router.extend({view:null,routes:{":page(/:tab)":"page"},initialize:function(){var e=i("./views/dashboard");n.Views.Dashboard=new e({el:"#thrive-theme-dashboard"}),n.Elements.$notification=s("#ttd-notification-box")},page:function(e,t){n.Views.Dashboard.page(e,t)}})),n.Elements.$document.on("keyup",function(e){return n.utils.do_action("theme.document.keyup",e)}).on("click",function(e){return n.utils.do_action("theme.document.click",e)}).on("tvd_after_auth",function(e,t){n.CONST.nonce=t.rest_nonce}),s(function(){Backbone.history.stop(),Backbone.history.start({hashchange:!0}),Backbone.history.fragment||n.Router.navigate(n.CONST.wizard.is_completed?"#templates":"#wizard",{trigger:!0})}),setTimeout(function(){return n.Elements.$body.removeClass("ttd-init")},1700),n.utils.add_action("theme.document.keyup",function(e){27===e.keyCode&&(n.Elements.$body.removeClass("ttd-init"),n.Elements.$document.find(".ttd-loading").removeClass("ttd-loading"))}),n.Elements.$window.on("message",function(e){var t=e.originalEvent;t.isTrusted&&t.data&&t.data.action&&n.utils.do_action("message:".concat(t.data.action),t.data)}),window.onbeforeunload=function(){s("body").addClass("ttd-loading")},i("./util/tooltips")},util:{"tooltips.js":function(e,t,i){var r;(r=jQuery)(function(){var n,a,o,e=r("body");r.widget("custom.ttdTooltip",r.ui.tooltip,{close:function(e,t,i){var s=arguments;a=(o=this)._superApply.bind(this),e&&e.toElement&&e.toElement.closest(".ui-tooltip")||(e.instantClose?a(arguments):n=setTimeout(function(){return a(s)},300))},closeAll:function(t){var i=this;Object.keys(this.tooltips).forEach(function(e){i.close(_objectSpread({currentTarget:i.tooltips[e].element},t))})}}),e.on("mouseleave",".ui-tooltip:not(.persistent)",function(e){o.closeAll()}).on("mouseenter",".ui-tooltip",function(){return clearTimeout(n)}),r(document).ttdTooltip({show:null,items:"[data-tooltip]",content:function(){var e=this.dataset.tooltip;return(e.startsWith("#")||e.startsWith("."))&&(e=r(e).clone().removeAttr("style")),e},open:function(e,t){r(".ui-tooltip").not(t.tooltip).hide();var i=r(this).data("customTtdTooltip").tooltips[t.tooltip[0].id].element[0],s=i.dataset.tooltipPosition||"top",n={of:i,my:"center top",at:"center bottom",using:function(e,t){r(this).css(e),r("<div>").addClass("ui-tt-arrow ".concat(t.vertical," ").concat(t.horizontal)).appendTo(this)}};switch(i.dataset.tooltipSide){case"bottom":n.at="center bottom+10",n.my="center top";break;case"right":n.at="right+10 center",n.my="left center";break;case"left":n.at="left-10 center",n.my="right center";break;case"top":default:n.at="center top-10",n.my="center bottom"}t.tooltip.addClass("ui-side-".concat(s)).position(n)}})})}},"utils.js":function(e,t,i){var n,s,a,o;n=jQuery,s="ttd-",a=i("./models/template"),o=i("./models/homepage-template"),t.exports={tpl:function(e,t){0!==e.indexOf(s)&&(e=s+e);var i=n("script#"+e.replace(/\//g,"-")).html()||"";return t?_.template(i)(t):_.template(i)},icon:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"ttd-";return e?this.tpl("dashboard/utils/icon")({icon:t+e}):""},add_filter:function(e,t,i){return void 0===i&&(i=10),this.filter_callbacks||(this.filter_callbacks={}),this.filter_callbacks[e]||(this.filter_callbacks[e]=[]),this.filter_callbacks[e].push({fn:t,priority:parseInt(i)}),this},remove_filter:function(e,t,i){if(!this.filter_callbacks)return this;if(void 0===t)return delete this.filter_callbacks[e],this;if(void 0===i&&(i=10),!this.has_filter(e))return this;for(var s,n=0;s=this.filter_callbacks[e][n++];)s.priority===i&&s.fn===t&&(n--,this.filter_callbacks[e].splice(n,1));return this},has_filter:function(e){return this.filter_callbacks&&this.filter_callbacks[e]&&this.filter_callbacks[e].length},apply_filters:function(e,i){if(arguments.length<1)return void 0!==i?i:null;if(this.has_filter(e)){var s=[];2<arguments.length&&(s=Array.prototype.slice.call(arguments,2));var t=this.filter_callbacks[e].sort(function(e,t){return e.priority-t.priority});n.each(t,function(e,t){t.fn&&(i=t.fn.apply(null,[i].concat(s)))})}return i},add_action:function(e,t,i){return void 0===i&&(i=10),this.action_callbacks||(this.action_callbacks={}),this.action_callbacks[e]||(this.action_callbacks[e]=[]),this.action_callbacks[e].push({fn:t,priority:parseInt(i)}),this},remove_action:function(e,t,i){if(!this.action_callbacks)return this;if(void 0===t)return delete this.action_callbacks[e],this;if(void 0===i&&(i=10),!this.has_action(e))return this;for(var s,n=0;s=this.action_callbacks[e][n++];)s.priority===i&&s.fn===t&&(n--,this.action_callbacks[e].splice(n,1));return this},has_action:function(e){return this.action_callbacks&&this.action_callbacks[e]&&this.action_callbacks[e].length},do_action:function(e){if(this.has_action(e)){var i=1<arguments.length?Array.prototype.slice.call(arguments,1):[],t=this.action_callbacks[e].sort(function(e,t){return e.priority-t.priority});n.each(t,function(e,t){t.fn&&t.fn.apply(null,i)})}},message:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"info",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4e3;TTD.Elements.$notification.attr("class",s+t+" "+s+"show").html(e),setTimeout(function(){TTD.Elements.$notification.removeClass(s+"show")},i)},capitalize:function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""},save_options:function(e,t,i){n.post({headers:{"X-WP-Nonce":TTD.CONST.nonce},url:TTD.CONST.routes.options,data:{name:e,value:t},dataType:"json"}).success(function(e){"function"==typeof i&&i(e)}).error(function(){TTD.utils.message("Error saving the option!","error")})},get_options:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";return n.get({headers:{"X-WP-Nonce":TTD.CONST.nonce},url:TTD.CONST.routes.options+"/"+i,data:{name:e},dataType:"json"}).success(function(e){"function"==typeof t&&t(e)}).error(function(){TTD.utils.message("Error retrieving the option!","error")})},tcb_editor_ajax_request:function(e,t,i){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"post";t=Object.assign({action:"tcb_editor_ajax",custom:e,nonce:TTD.CONST.editor_nonce},t),n.ajax({url:ajaxurl,type:s,data:t}).success(function(e){"function"==typeof i&&i(e)}).error(function(){TTD.utils.message("Error!","error")})},local_storage_set:function(e,t){if(window.localStorage&&e&&null!=t){"object"===_typeof(t)&&(t=JSON.stringify(t));try{window.localStorage.setItem(e,t)}catch(e){console.log(e)}}},content_smaller_than_screen:function(e){var i=0;return e.children().each(function(e,t){return i+=t.offsetHeight}),i+32<window.innerHeight},media_library_instance:function(t,i,e){return void 0===TTD.objects.media[t]&&(e=Object.assign({title:"Choose an image",button:{text:"Select"},multiple:!1,frame:"select",library:{type:"image"}},e),TTD.objects.media[t]=wp.media.frames.file_frame=wp.media(e),TTD.objects.media[t].on("select",function(){if("function"==typeof i){var e=TTD.objects.media[t].state().get("selection").first().toJSON();i(e)}})),TTD.objects.media[t]},save_preview_image:function(e,t,i){TTD.utils.save_options(e,t.id,function(){t.button.css("background-image","url("+t.src+")"),t.reset&&t.reset.toggle(i),TTD.utils.message("Image saved successfully!","success")})},save_skin_meta:function(e,t,i){var s=this;TTD.objects.collections.skins.get_active_skin().save(_defineProperty({},e,t),{success:function(e){"function"==typeof i&&i(e)},error:function(e,t,i){s.error(e,t,i)}})},validate_url:function(e){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},reload_iframe:function(e){e.attr("src",e[0].contentWindow.location.href)},loading:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];TTD.Elements.$body.toggleClass("ttd-loading",e)},init_scrollbar:function(e,t){e.addClass("scrollbar-inner").scrollbar(t)},is_in_viewport:function(e){var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},getCssVariableValue:function(e){return e=e.replace(/var\(|\)/gi,"").trim(),window.getComputedStyle(document.body).getPropertyValue(e)},toFixed:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return Number(Math.round(parseFloat(e)+"e"+t)+"e-"+t)},changeCssVariableValue:function(e,t){document.getElementsByClassName("ttd-site-preview")[0].contentWindow.document.documentElement.style.setProperty(e,t),document.documentElement.style.setProperty(e,t)},homepageType:function(){return"posts"===TTD.CONST.options.show_on_front?"blog":"page"},isHomeLandingPage:function(){return!!TTD.CONST.options.is_landing_page},templateModelFactory:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e&&e.meta_input&&"home"===e.meta_input.primary_template?new o(e):new a(e)},filterObjectPropertiesByKey:function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return Object.keys(i).filter(function(e){return t.includes(e)}).reduce(function(e,t){return e[t]=i[t],e},{})},filterDataByAllowedArr:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],s=[];return _.each(e,function(e){s.push(t.filterObjectPropertiesByKey(e,i))}),s},isWooStep:function(e){return"woo_header"===e||"woo_footer"===e},addUrlParam:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=new URL(e);return n.isPlainObject(t)?Object.keys(t).forEach(function(e){return s.searchParams.append(e,t[e])}):s.searchParams.append(t,i),s.toString()},sendApiRequest:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i={namespace:"ttb/v1",endpoint:e,type:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"POST",data:t};return i.headers={"X-WP-Nonce":TTD.CONST.nonce},n.ajax(wp.apiRequest.buildAjaxOptions(i))},tooltipDismissed:function(e){return TTD.CONST.dismissed_tooltips.includes(e)},reloadDashboard:function(){TTD.Views.Dashboard&&TTD.Views.Dashboard.$el.addClass("ttd-loading"),location.reload()}}},views:{"base.js":function(e,t,i){t.exports=Backbone.View.extend({events:{"click .click":"_call","input .input":"_call","change .change":"_call","mousedown .mousedown":"_call","mouseenter .mouseenter":"_call","mousemove .mousemove":"_call","mouseup .mouseup":"_call","keyup .keyup":"_call","keydown .keydown":"_call","blur .blur":"_call","mouseleave .mouseleave":"_call"},initialize:function(e){return e=e||{},"function"==typeof this.before_initialize&&this.before_initialize(e),!e.preventRender&&this.render(e),"function"==typeof this.after_initialize&&this.after_initialize(e),this},_call:function(e){if(e.currentTarget.disabled)return!1;var t=e.currentTarget.getAttribute("data-fn-"+e.type)||e.currentTarget.getAttribute("data-fn");return t&&"__return_false"===t?(e.stopPropagation(),e.preventDefault(),!1):"function"==typeof this[t]?this[t].call(this,e,e.currentTarget):void 0},show:function(){return this.$el.show(),this},hide:function(){return this.$el.hide(),this},toggle:function(e){return e?this.show():this.hide()},toggleClass:function(e,t){return this.$el.toggleClass(e,t),this},render:function(e){return"function"==typeof this.before_render&&this.before_render(e),this.template&&_.isString(this.template)&&(this.template=TTD.utils.tpl(this.template)),this.template&&this.$el.html(this.template()),"function"==typeof this.after_render&&this.after_render(e),this},error:function(e,t,i){var s="";if(t.responseJSON)s=t.responseJSON.message;else if(t.responseText)try{if("parsererror"===i)s="Could not parse response: "+t.responseText;else s=JSON.parse(t.responseText).message}catch(e){}s||(s=(t.statusText||i)+(t.status?" ("+t.status+")":"")),TTD.utils.message(s,"error")},obj:function(e){return TTD&&TTD.objects&&TTD.objects[e]}})},"dashboard.js":function(e,t,i){var s,n,a,o,r,l;s=jQuery,n={templates:i("../views/sidebar/templates"),typography:i("../views/sidebar/typography"),branding:i("../views/sidebar/branding/main"),settings:i("../views/sidebar/settings"),wizard:i("../views/sidebar/wizard/main"),performance:i("../views/sidebar/performance")},a={templates:i("../views/main/templates/main"),typography:i("../views/main/typography/main"),branding:i("../views/main/branding"),settings:i("../views/main/settings"),wizard:i("../views/main/wizard"),performance:i("../views/main/performance/main")},o=i("./skins/main"),r=i("../views/theme-info"),l=i("./no-skin"),t.exports=i("./base").extend({template:"dashboard/main",$icons:null,$main:null,$sidebar:null,$themeInfo:null,after_render:function(){TTD.Elements.$modals=s("#ttd-modals"),this.$icons=new(i("../views/icon-menu"))({el:this.$(".ttd-icon-menu")[0]}),this.$skins=new o({el:this.$(".ttd-skins-container")[0]}),TTD.utils.add_action("message:ttb.thumbnail.generated",this.onThumbnailGenerated.bind(this))},page:function(e,t){n[e]&&a[e]||(e="templates"),this.$main&&this.$sidebar&&(this.$main.undelegateEvents(),this.$sidebar.undelegateEvents()),"default"===TTD.objects.collections.skins.get_active_skin().get("tag")?l.setElement(s('<div class="ttd-no-skin-page"></div>').appendTo(this.$el)).render():(this.$main=new a[e]({el:this.$(".ttd-main-container")[0],tab:t}),this.$sidebar=new n[e]({el:this.$(".ttd-sidebar-container")[0],tab:t}),this.$icons.set_active(e),this.render_theme_info(0),this.$(".scrollbar-inner").scrollbar()),this.$el.addClass("ttd-page-".concat(e))},render_theme_info:function(e){this.$(".ttd-theme-info").length&&this.$(".ttd-theme-info").remove(),this.$themeInfo=new r({model:TTD.objects.collections.skins.get_active_skin(),skinsView:this.$skins,iconsView:this.$icons,is_collapsed:e}),this.$sidebar.$el.prepend(this.$themeInfo.$el)},onThumbnailGenerated:function(e){this.$main.onThumbnailGenerated&&this.$main.onThumbnailGenerated(e)}})},"icon-menu.js":function(e,n,a){!function(e){var t,i;TTD.CONST.wizard.is_completed?(i=TTD.utils.addUrlParam(TTD.CONST.admin_url+"admin.php",{page:"thrive-theme-dashboard"}),t=TTD.utils.addUrlParam(i,"tab","w")):(t=TTD.utils.addUrlParam(TTD.CONST.admin_url+"admin.php",{page:"thrive-theme-dashboard"}),i=TTD.utils.addUrlParam(t,"tab","other"));var s=[{icon:"wizard",label:"Site Wizard",disabled:!1,baseUrl:t},{icon:"branding",label:"Branding",disabled:!1,baseUrl:i},{icon:"typography",label:"Typography",disabled:!1,baseUrl:i},{icon:"templates",label:"Templates",disabled:!1,baseUrl:i},{icon:"performance",label:"Site Speed",disabled:!1,baseUrl:i}];n.exports=a("./base").extend({template:"dashboard/icon-menu",render:function(){var t=this;s.forEach(function(e){return t.$el.append(TTD.utils.tpl(t.template)(e))})},set_active:function(e){this.$(".active").removeClass("active"),this.$('[data-icon="'+e+'"]').addClass("active")}})}(jQuery)},main:{"branding.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/main/branding"})},performance:{"amp.js":function(e,t,i){var a,s;a=jQuery,s=i("./../../../models/base").extend({urlRoot:TTD.CONST.routes.amp,postTypeEnabled:function(e){var t=this.get("post_types");return t&&t[e]},setPostType:function(e,t){var i=this.get("post_types");return i||(i={}),i[e]=t,this.set("post_types",i),this}}),t.exports=i("../../base").extend({template:"dashboard/main/performance/amp/main",before_initialize:function(){this.settings=new s(TTD.CONST.amp.settings),this.post_types=TTD.CONST.amp.post_types},after_render:function(){this.$settingsContainer=this.$(".ttd-amp-settings").toggle(this.settings.get("enabled")),this.$introContainer=this.$(".ttd-amp-intro").toggle(this.settings.get("enabled")),this.toggleAnalytics(this.settings.get("analytics_enabled"))},getLabelText:function(){return this.settings.get("enabled")?"Disable":"Enable"},enable:function(e,t){this.saveSetting("enabled",t.checked),this.$settingsContainer.toggle(t.checked),this.$introContainer.toggle(t.checked)},enablePostType:function(e,t){this.settings.setPostType(t.dataset.type,t.checked).save(null,{success:function(){TTD.utils.message("Post type setting saved successfully!","success",1e3)},error:function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}})},toggleInternalLinking:function(e,t){this.saveSetting("internal_linking",t.checked)},analytics:function(e,t){var i=this.$("textarea.amp-analytics").val(),s=a(t),n=this.$(".configured-state");this.isCodeValid(i)?this.settings.set("analytics",i).save(null,{success:function(){s.hide(),n.show(),setTimeout(function(){s.show(),n.hide()},1e3),TTD.CONST.amp.settings.analytics=i},error:function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}}):TTD.utils.message("Your Google Analytics code is not valid","error")},isCodeValid:function(t){var e=["amp-analytics","gtag"].some(function(e){return t.includes(e)});return e=(e=e&&!["script","amp-analytics"].some(function(e){return t.split("<"+e).length!==t.split("</"+e+">").length}))&&!t.includes("GA_MEASUREMENT_ID"),""===t||!!e},toggleAnalyticsListener:function(e,t){var i=t.checked;this.saveSetting("analytics_enabled",i),this.toggleAnalytics(i)},saveSetting:function(e,t){var i=this;this.settings.set(e,t).save(null,{success:function(){TTD.utils.message("Setting saved successfully!","success",1e3),TTD.CONST.amp.settings[e]=t,i.render()},error:function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}})},toggleAnalytics:function(e){this.$settingsContainer.find(".ttd-amp-analytics").toggle(e)}})},cache:{"main.js":function(e,t,i){var s,n,a;s=jQuery,n=i("./../../../../collections/plugins"),a=i("./plugin"),t.exports=i("../../../base").extend({template:"dashboard/main/performance/cache/main",before_initialize:function(){void 0===TTD.objects.collections.plugins&&(TTD.objects.collections.plugins=new n(TTD.CONST.cache_plugins)),this.collection=TTD.objects.collections.plugins,this.collection.on("custom_event",this.render.bind(this))},after_render:function(){this.renderPlugins(),this.$(".ttd-performance-notice.warning").toggle(1<this.collection.activePlugins().length)},renderPlugins:function(){var i=this.$(".ttd-plugins-container").empty();this.collection.sort().each(function(e){var t=new a({model:e});i.append(t.$el)})},closeNotice:function(e,t){s(t).parent(".ttd-performance-notice").hide()}})},"plugin.js":function(e,t,i){var s,n;jQuery,s=i("../../../base"),n=s.extend({template:"dashboard/main/performance/cache/button",className:"ttd-d-flex button-box",before_initialize:function(e){this.plugin=e.plugin,this.model=new Backbone.Model(this.getBtnOptions()),this.model.on("change",this.render.bind(this))},after_render:function(){this.plugin.get("configured")&&this.$("button.configured-state").removeClass("ttd-btn blue click fill")},getBtnOptions:function(){var e="",t="",i="";return this.plugin.get("active")?(e="showConfirmSettings",t="Configure for Optimal Caching with Thrive"):i=(t=this.plugin.get("installed")?(e="activate","Activate"):(e="install","Install Now"),"btn-w-150"),this.plugin.get("configured")&&(e="",t="Configured",i="configured-state"),{fn:e,text:t,class:i}}}),t.exports=s.extend({className:"ttd-performance-card compact plugin-item mb-20",template:"dashboard/main/performance/cache/plugin",after_initialize:function(){this.model.on("change",this.render.bind(this))},after_render:function(){this.$confirmSettings=this.$(".confirm-settings"),this.$confirmActivate=this.$(".confirm-activate"),this.btnView=new n({plugin:this.model}),this.$(".ttd-plugin-btn-container").append(this.btnView.$el)},install:function(e){var t=this;return this.btnView.model.set({text:"Installing...",class:"installing btn-w-150"}),this.model.pluginAction("install",["slug"],["installed"]).then(function(){t.render()}),!1},activate:function(){var e=this.model.collection.getLatestActivePlugin();return e?(this.toggleConfirm("activate",!0),this.$confirmActivate.find(".ttd-active-plugin-name").html(e.get("name"))):this.activatePlugin(),!1},activatePlugin:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.model.pluginAction("activate",["file"],["active"],t).then(function(){e.$el.removeClass("notice-state").siblings().hide(),e.showSuccessMessage(),t._and_deactivate&&e.model.collection.findWhere({file:t._and_deactivate}).set({active:!1,configured:!1})}),!1},showSuccessMessage:function(){var e=TTD.Views.Dashboard.$main.currentTabView.$(".success");e.show().find(".ttd-cache-plugin-name").html(this.model.get("name")),setTimeout(function(){e.fadeOut()},7e3)},confirmActivate:function(){var e=this.model.collection.getLatestActivePlugin();return e&&this.activatePlugin({_and_deactivate:e.get("file")}),!1},cancelActivate:function(){return this.toggleConfirm("activate",!1),!1},showConfirmSettings:function(){return TTD.Views.Dashboard.$main.currentTabView.$(".success").hide(),this.toggleConfirm("settings",!0),!1},cancelUpdateSettings:function(){return this.toggleConfirm("settings",!1),!1},toggleConfirm:function(e,t){("activate"===e?this.$confirmActivate:this.$confirmSettings).toggle(t),this.$el.toggleClass("notice-state",t)},updateSettings:function(){var e=this;return this.model.pluginAction("settings",["tag"],["configured"]).then(function(){e.$(".confirmation").hide(),e.$(".success").show(),e.$confirmSettings.show(),setTimeout(function(){e.$el.removeClass("notice-state").siblings().show(),e.model.collection.trigger("custom_event")},1e3)}),!1}})}},"image.js":function(e,t,i){var s;s=jQuery,t.exports=i("../../base").extend({template:"dashboard/main/performance/image",before_render:function(){this.hasPlugins()||(this.state="optimole")},optionClick:function(e){s(e.currentTarget).addClass("selected").siblings().removeClass("selected"),this.$(".action-option").hide().filter("#opt--".concat(e.currentTarget.dataset.opt)).show(),this.state=e.currentTarget.dataset.opt},hasPlugins:function(){return Object.values(this.plugins).filter(function(e){return e.active}).length},get plugins(){return TTD.CONST.image_optimization_plugins},renderPluginCard:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=this.plugins[e]),e?TTD.utils.tpl("dashboard/main/performance/image/plugin")({plugin:_objectSpread({},e,{},t)}):""},pluginAction:function(e){var t=this,i=e.currentTarget.dataset.plugin,s="activate"===e.currentTarget.dataset.action?"Activating":"Installing and activating";e.currentTarget.classList.add("installing"),e.currentTarget.textContent="".concat(s," plugin...");var n=this.plugins[i].settings_redirect;return TTD.utils.sendApiRequest("plugins/install",{slug:this.plugins[i].slug.split("/").shift(),file:this.plugins[i].slug,_and_activate:1}).done(function(e){t.plugins[i].installed=t.plugins[i].active=1,n&&(location.href=t.plugins[i].settings_redirect)}).error(function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}).always(function(){n||t.render()}),!1},cancelUpdateSettings:function(e){var t=e.currentTarget.closest(".plugin-item");return t.classList.remove("state-warn"),t.classList.add("state-normal"),!1},showConfigState:function(e){var t=e.currentTarget.closest(".plugin-item");return t.classList.remove("state-normal"),t.classList.add("state-warn"),!1},updateSettings:function(e){var t=this,i=e.currentTarget.dataset.plugin;return e.currentTarget.classList.add("installing"),e.currentTarget.textContent="Configuring...",TTD.utils.sendApiRequest("plugins/settings",{tag:e.currentTarget.dataset.tag}).done(function(e){t.plugins[i].status.configured=!0,t.$(".confirmation").hide(),t.$(".success").show()}).error(function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}).always(function(){setTimeout(t.render.bind(t),2e3)}),!1}})},"main.js":function(e,t,i){var s;jQuery,s={cache:i("./cache/main"),image:i("./image"),amp:i("./amp")},t.exports=i("../../base").extend({template:"dashboard/main/performance/main",before_initialize:function(e){e.tab&&void 0!==s[e.tab]&&(e.preventRender=!0,this.currentTabView=new s[e.tab]({el:this.el}))}})}},"settings.js":function(e,t,i){var s,n;s=jQuery,n=!1,t.exports=i("../base").extend({template:"dashboard/main/settings",after_render:function(){var t=this;this.featured_image_settings_button=this.$("button#ttd-featured-image-default"),this.featured_image_settings_reset=this.$(".ttd-featured-image-reset"),this.featured_image_settings_reset.toggle(TTD.CONST.settings.featured_image.default!==TTD.CONST.settings.featured_image.placeholder),this.featured_image_settings_button.css("background-image","url("+TTD.CONST.settings.featured_image.default+")");var e={title:"Choose a new default featured image"};TTD.utils.media_library_instance("upload_featured_image",function(e){return t.save_featured_image(e.id,e.url)},e),TTD.utils.media_library_instance("upload_social_media_image",function(e){return t.save_social_media_image(e.url)},e),this.$("#ttd-inline-css-option").prop("checked",!!parseInt(TTD.CONST.settings.inline_css))},render:function(){this.$el.html(TTD.utils.tpl(this.template)({settings:TTD.CONST.settings})),this.after_render(),this.toggle_elem()},toggle_elem:function(){this.$(".ttd-subtitle").on("click",function(){s(this).toggleClass("rotate").next().slideToggle(150)})},open_media:function(e){var t=TTD.objects.media[e.target.dataset.type];void 0===t?TTD.utils.message("Error while opening the media gallery!","error"):t.open()},save_social_media_image:function(e){this.social_media_image=e,this.$("#ttd-social-media-image").css("background-image","url("+e+")"),this.$(".ttd-social-media-image-reset").removeClass("ttd-hide"),this.save_social_media("image")},save_input:function(e){"keydown"!==e.type||(n=27===e.keyCode,13===e.keyCode)?n?n=!1:""!==e.currentTarget.value&&this.save_social_media(e.currentTarget.name.split("_").pop()):27===e.keyCode&&this.render()},reset_featured_image:function(){this.save_featured_image(0,TTD.CONST.settings.featured_image.placeholder)},save_featured_image:function(e,t){var i=t!==TTD.CONST.settings.featured_image.placeholder,s={id:e,src:t,button:this.featured_image_settings_button,reset:this.featured_image_settings_reset};TTD.utils.save_preview_image("thrive-theme-default-featured-image",s,i),TTD.CONST.settings.featured_image.default=t},save_option:function(e,t){"checkbox"===t.type&&TTD.utils.save_options(t.name,t.checked?1:0,function(){TTD.utils.message("Setting saved successfully!","success")})}})},templates:{"filters.js":function(e,t,i){jQuery,t.exports=i("../../base").extend({template:"dashboard/main/templates/filters",before_initialize:function(){this.listenTo(this.model,"theme_dash:filter",this.render)},before_render:function(){this.contentTypes=this.getContentTypes(),this.counter=0},after_render:function(){this.$filterTitle=this.$(".templates-title"),this.$counter=this.$(".templates-counter")},toggleDropdown:function(){this.$(".ttd-dropdown-w-count").toggleClass("ttd-dwc-selected")},mainFilter:function(e){var t=e.currentTarget.dataset.template;this.toggleDropdown(),TTD.objects.models.filter.setOptions({title:t,template:t,post_type:""})},postType:function(e){var t=e.currentTarget.getAttribute("data-post-type"),i="all"===t?"Custom Post":t;this.toggleDropdown(),TTD.objects.models.filter.setOptions({title:i,post_type:t,template:"post_type"})},getContentTypes:function(){return _.each(TTD.CONST.content_types,function(e){var t=TTD.objects.collections.templates.postTypeHasTemplate(e.key);e.hideInDropdown=!t&&e.key!==TTD.CONST.woocommerce.key||e.exclude_from_dropdown}),TTD.CONST.content_types},filterByModel:function(e){var t;if(e.isHomepage())t={title:"Homepage",post_type:e.secondary(),template:"homepage"};else if(e.isSingular())t={title:e.secondary(),post_type:e.secondary(),template:"post_type"};else{var i="archive"===e.primary()?"archive":"core";t={title:i,template:i,post_type:""}}TTD.objects.models.filter.setOptions(t)}})},"homepage-item.js":function(e,t,i){var s=i("./item.js");t.exports=s.extend({className:"theme-template",template:"dashboard/main/templates/homepage-item",before_initialize:function(){var t=this;this.model.isLandingPage()&&this.model.set("edit_url",TTD.CONST.options.edit_url),TTD.objects.collections.templates.on("remove",function(e){e.get("ID")===t.model.get("ID")&&t.remove()})},after_render:function(){s.prototype.after_render.call(this),this.model.inheritsTemplate()&&!this.model.isLandingPage()&&this.$el.addClass("inherit-page-template"),this.model.isLandingPage()&&this.$el.addClass("is-landing-page"),TTD.utils.homepageType()===this.model.secondary()&&this.$el.addClass("blue-homepage-label")},newHomepage:function(){TTD.objects.modals.newHomepageTemplate.open()}})},"item.js":function(e,t,i){var s,n;s=jQuery,n=i("../../../models/template"),t.exports=i("../../base").extend({className:"theme-template",template:"dashboard/main/templates/item",after_initialize:function(e){var t=this;this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change",this.render),this.model.set("post_title",this.model.name()),this.el.addEventListener("mouseleave",function(){t.el.classList.remove("tooltip-open")}),this.optionsTooltip=e.optionsTooltip},after_render:function(){this.$name=this.$(".template-name"),this.$el.css("order",this.model.getOrder()).attr("data-primary",this.model.primary()).attr("data-secondary",this.model.secondary()),this.saving=!1,this.loading(!1)},delete:function(){TTD.objects.modals.delete_template.open({model:this.model})},reset:function(){TTD.objects.modals.reset_template.open({model:this.model})},loading:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.$el.toggleClass("ttd-loading",e)},makeDefault:function(){var t=this;if(1===parseInt(this.model.meta("default")))return!1;this.loading(),this.model.meta("default",1),this.model.save({action:"make_default"},{wait:!0,success:function(){TTD.objects.collections.templates.forEach(function(e){t.model.get("ID")!==e.get("ID")&&t.model.primary()===e.primary()&&t.model.secondary()===e.secondary()&&t.model.variable()===e.variable()&&t.model.format()===e.format()&&(e.meta("default",0),e.trigger("change",e))}),t.render(),TTD.utils.message("The template is now <b>default</b> !")},error:function(){t.loading(!1),TTD.utils.message("Error making template default!","error")}})},editTitle:function(){this.$name.html(s("<input>",{class:"blur keyup",value:this.model.name(),"data-fn-focusout":"saveTitle","data-fn-keyup":"titleKeyUp"})).find("input").focus()},saveTitle:function(){var e=this;if(!this.saving){this.saving=!0;var t=this.$name.find("input").val();if(t===this.model.get("post_title"))return this.render();this.loading(),this.model.save({post_title:t,action:"update_fields",fields:{post_title:t}},{wait:!0,success:function(){return e.render()&&TTD.utils.message("Title <b>changed</b> successfully!")},error:function(){return TTD.utils.message("Error saving the title!","error")}})}},titleKeyUp:function(e){switch(e.which){case 13:this.saveTitle();break;case 27:this.saving=!0,this.render()}},duplicate:function(){var t=this,e=TTD.utils.templateModelFactory({meta_input:{primary_template:this.model.primary(),secondary_template:this.model.secondary(),format:this.model.format(),default:0},thumbnail:this.model.get("thumbnail"),post_title:"Copy of ".concat(this.model.name())});this.loading(),e.save({inherit_from:this.model.get("ID")},{wait:!0,success:function(e){TTD.objects.collections.templates.add(e),TTD.utils.message("Template <b>duplicated</b> successfully!","success"),t.loading(!1)},error:function(){TTD.utils.message("Error creating template!","error")}})},showOptionsTooltip:function(){this.optionsTooltip.$('.ttd-tooltip-row[data-fn="duplicate"]').toggle(this.model.canDuplicate()),this.optionsTooltip.$('.ttd-tooltip-row[data-fn="delete"]').toggleClass("default",this.model.isCore()&&this.model.isDefault()),this.optionsTooltip.$('.ttd-tooltip-row[data-fn="makeDefault"]').toggleClass("default",this.model.isDefault()),this.optionsTooltip.$(".ttd-template-preview-url").attr("href",this.model.get("preview_url")),this.$el.append(this.optionsTooltip.$el.css({bottom:70})),this.$el.toggleClass("tooltip-open")},fallback:function(){var i=this,e=new n({meta_input:{primary_template:this.model.primary(),secondary_template:this.model.secondary(),default:0},post_title:this.model.name()});this.loading(),e.save({fallback:this.model.get("ID"),inherit_from:this.model.get("ID")},{wait:!0,success:function(e,t){i.remove(),TTD.CONST.templates.push(t),TTD.objects.collections.templates.add(e),TTD.utils.message("Template <b>created</b> successfully!","success"),i.loading(!1)},error:function(){TTD.utils.message("Error creating template!","error")}})}})},"list.js":function(e,t,i){var s,n=i("./item"),a=i("./homepage-item"),o=i("../../base").extend({tagName:"div",className:"tcb-template-options-tooltip",template:"dashboard/main/templates/options-tooltip"});s=jQuery,t.exports=i("../../base").extend({before_initialize:function(e){var i=this;this.optionsTooltip=new o,this.type=e.type,TTD.utils.add_action("theme.document.click",function(e){var t=s(e.target);t.is(".tcb-template-options-tooltip")||0!==t.closest(".ttd-dropdown-dots").length||i.hideOptionsTooltip()})},renderCollection:function(){var t=this,e=TTD.objects.collections.templates.filterItems(this.type);this.counter=e.length,this.$el.empty(),this.$el.closest(".ttd-templates-area").toggle(!!e.length),_.each(e,function(e){t.renderTemplate(e)})},renderTemplate:function(e){var t=new(e.isHomepage()?a:n)({model:e,optionsTooltip:this.optionsTooltip});if(this.$el.append(t.$el),e.isJustAdded()){if(!TTD.utils.is_in_viewport(t.el)){var i=t.el.getBoundingClientRect().top-60;window.scrollTo({top:i,behavior:"smooth"})}t.$el.addClass("ttd-just-added"),setTimeout(function(){return t.$el.removeClass("ttd-just-added")},5e3),e.set("just_added",0)}},hideOptionsTooltip:function(){this.$(".tooltip-open").removeClass("tooltip-open")}})},"main.js":function(e,t,i){var s,n=i("../../modals/templates/delete"),a=i("../../modals/templates/reset"),o=i("../../modals/templates/post-create"),r=i("../../modals/templates/create/create-homepage"),l=i("../../modals/templates/create/create"),c=i("../../../models/filter"),d=i("./filters"),h=i("./item"),p=i("./list");s=jQuery,t.exports=i("../../base").extend({template:"dashboard/main/templates/main",before_initialize:function(){TTD.objects.models.filter=new c,this.listenTo(TTD.objects.models.filter,"theme_dash:filter",this.renderTemplates),TTD.objects.collections.templates.off("add",this.afterModelAdd).on("add",this.afterModelAdd)},afterModelAdd:function(e){TTD.objects.collections.templates.modelInItemsFiltered(e)?TTD.Views.Dashboard.$main["$".concat(e.getType(),"TemplatesView")].renderTemplate(e):TTD.Views.Dashboard.$main.$filters.filterByModel(e)},after_initialize:function(){TTD.objects.modals.newHomepageTemplate=new r,TTD.objects.modals.newPostTemplate=new o,TTD.objects.modals.newTemplate=new l,TTD.objects.modals.delete_template=new n({type:"small"}),TTD.objects.modals.reset_template=new a({type:"small"})},after_render:function(){this.$singleTemplatesView=new p({el:".ttd-templates-inner.single",type:"single",preventRender:!0}),this.$listTemplatesView=new p({el:".ttd-templates-inner.list",type:"list",preventRender:!0}),this.renderTemplates(),this.$filters=new d({model:TTD.objects.models.filter}),this.$(".ttd-settings-container").prepend(this.$filters.$el)},renderTemplates:function(){this.checkHomepageTemplate(),this.$singleTemplatesView.renderCollection(),this.$listTemplatesView.renderCollection(),TTD.objects.models.filter.setOptions({counter:this.$singleTemplatesView.counter+this.$listTemplatesView.counter},!0)},renderFallback:function(){var t=this;this.getTemplateFallback().then(function(e){if(e.updated&&delete e.updated,Object.keys(e).length){t.$(".missing-templates-label").show();var i=TTD.objects.collections.templates.map(function(e){return parseInt(e.get("ID"))}),s=t.$(".fallback-templates-list");s.show(),_.each(e,function(e){if(!i.includes(parseInt(e.ID))&&!e.fallback.some(function(e){return i.includes(parseInt(e))})){e.isFallback=!0;var t=new h({model:TTD.utils.templateModelFactory(e)});s.append(t.$el)}})}else t.$(".missing-templates-label").hide()})},getTemplateFallback:function(){return new Promise(function(t,e){TTD.CONST.fallback.updated?t(TTD.CONST.fallback):s.ajax({headers:{"X-WP-Nonce":TTD.CONST.nonce},url:"".concat(TTD.CONST.routes.options,"/fallback"),type:"GET"}).success(function(e){t(e)}).error(function(){TTD.utils.message("Could not retrieve missing templates!","error")})})},add:function(e,t){TTD.objects.modals.newPostTemplate.open({collection:TTD.objects.collections.templates,meta_input:{primary_template:t.dataset.primary,secondary_template:t.dataset.secondary}})},addPageTemplate:function(){TTD.objects.modals.newTemplate.open()},onThumbnailGenerated:function(e){var t=TTD.objects.collections.templates.findWhere({ID:parseInt(e.post_id)});t&&(t.set("thumbnail",e.thumb),t.trigger("change"))},checkHomepageTemplate:function(){var e=TTD.objects.collections.templates.filter(function(e){return e.isHomepage()&&e.secondary()===TTD.utils.homepageType()});if("posts"===TTD.CONST.options.show_on_front&&TTD.objects.collections.templates.filter(function(e){return e.isHomepage()&&"single"===e.getType()}).forEach(function(e){TTD.objects.collections.templates.remove(e.get("ID"))}),0<e.length)TTD.objects.collections.templates.remove(0,{silent:!0});else{var t,i={ID:0,meta_input:{default:1,primary_template:"home",secondary_template:TTD.utils.homepageType()}};"page"!==TTD.utils.homepageType()||TTD.utils.isHomeLandingPage()?"blog"===TTD.utils.homepageType()&&(t=TTD.objects.collections.templates.find(function(e){return e.isDefault()&&"archive"===e.primary()})):(t=TTD.objects.collections.templates.find(function(e){return e.isSingular()&&e.isDefault()&&"page"===e.secondary()}))||(t=TTD.objects.collections.templates.find(function(e){return e.isSingular()&&e.isDefault()})),t&&(i=s.extend(!0,{},t.attributes,i)),TTD.objects.collections.templates.add(TTD.utils.templateModelFactory(i),{silent:!0})}}})}},typography:{"item.js":function(e,t,i){jQuery,t.exports=i("../../base").extend({tagName:"div",className:"ttd-typography-block",template:"dashboard/main/typography/item",after_initialize:function(){this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change",this.render)},before_render:function(){this.$el.addClass("loader-absolute ttd-loading small")},after_render:function(){var e=this;this.model.get("is_new")&&(this.$el.addClass("new-typography"),setTimeout(function(){e.$el.removeClass("new-typography"),e.model.set({is_new:!1},{silent:!0})},4e3)),this.$("iframe").on("load",function(){requestAnimationFrame(function(){return e.$el.removeClass("ttd-loading")})})},block_click:function(e){return e.preventDefault()},delete:function(){TTD.objects.modals.delete_typography.open({model:this.model})},toggle:function(){this.$el.toggleClass("ttd-block-expand");var e=this.$el.hasClass("ttd-block-expand");this.$(".height-toggle .text").html(e?"COLLAPSE":"EXPAND")},set_active:function(){var t=this;TTD.utils.loading(),this.model.collection.each(function(e){e.meta("default",e.get("ID")===t.model.get("ID")?1:0)}),this.model.collection.sort(),this.model.collection.trigger("render"),this.model.save({action:"set_default"},{success:function(e){TTD.utils.message("Active Typography changed!")},error:function(){return TTD.utils.message("Error setting the typography set as default!","error")},complete:function(){return TTD.utils.loading(!1)}})},name_edit:function(){this.$(".edit").hide(),this.$(".state-edit").show().find("input").focus().select()},cancelNameEdit:function(){this.$(".edit").show(),this.$(".state-edit").hide().find("input").val(this.model.get("post_title"))},save_title:function(e){if("keyup"===e.type){if(27===e.which)return this.cancelNameEdit();if(13!==e.which)return}var t=this.$("input.title").val().trim();t!==this.model.get("post_title")?t&&0!==t.length&&(this.model.set("post_title",t),this.model.save({post_title:t,action:"update_fields",fields:{post_title:t}},{success:function(){return TTD.utils.message("Title <b>changed</b> successfully!")},error:function(){return TTD.utils.message("Error saving the title!","error")}})):this.cancelNameEdit()},reset:function(){TTD.objects.modals.reset_typography.open({model:this.model})}})},"main.js":function(e,t,i){var s,n,a,o,r;jQuery,s=i("../../modals/typography/delete"),n=i("../../modals/typography/reset"),a=i("../../../collections/typography"),o=i("./item"),r=i("../../../models/typography"),t.exports=i("../../base").extend({template:"dashboard/main/typography/main",after_initialize:function(){var i=this;TTD.objects.modals.delete_typography=new s({type:"small"}),TTD.objects.modals.reset_typography=new n({type:"small"}),void 0===TTD.objects.collections.typography&&(TTD.objects.collections.typography=new a(TTD.CONST.typography),this.listenTo(TTD.objects.collections.typography,"frame-height-update",function(e,t){this.$("#ttd-typography-block-".concat(e)).css("height",t+15+"px")}),this.listenTo(TTD.objects.collections.typography,"add",this.addToList.bind(this)),this.listenTo(TTD.objects.collections.typography,"render",this.render_list.bind(this)),TTD.utils.add_action("message:ttb-typography-saved",function(e){var t=i.collection.findWhere({ID:parseInt(e.post_id)});t&&t.trigger("change")})),this.collection=TTD.objects.collections.typography,this.collection.sort(),this.render_list()},create:function(){var t=this,i=new r({post_title:"New Typography Set"});TTD.utils.loading(),i.save({},{wait:!0,success:function(e){TTD.Elements.$body.removeClass("ttd-loading "),i.set("is_new",!0),t.collection.add(e),TTD.utils.message("Typography set <b>created</b> successfully!","success")},error:function(){TTD.utils.message("Error creating typography set!","error")}})},afterRender:function(){this.$(".ttd-subtitle").toggleClass("ttd-hide",this.collection.length<=1)},render_list:function(){var t,i=this.$(".ttd-default-typography").empty(),s=this.$(".ttd-other-typography").empty();this.collection.each(function(e){t=new o({model:e}),e.is_active()?i.append(t.$el):s.append(t.$el)}),this.afterRender()},addToList:function(e){this.$(".ttd-other-typography").prepend(new o({model:e}).$el),this.afterRender()}})}},wizard:{"color.js":function(e,t,i){var s,n;jQuery,s=i("../../sidebar/branding/skin-palettes/list"),n=i("../../base").extend({template:"dashboard/main/wizard/overlay-color",wizard:i("../../../models/wizard"),after_initialize:function(){TTD.utils.add_action("skin_color_updated",this.onColorUpdated.bind(this))},after_render:function(){this.skin_palettes=new s({el:this.$("#wizard-step-color-palette"),spectrumOptions:{saveOnApply:!1,appendTo:"#wizard-spectrum-container"}})},onColorUpdated:function(e){this.savedColorData=e},clickNext:function(){return this.parent.loading(),this.wizard.setStepData({save_data:this.savedColorData||""},!0).completeStep(!1),!1}}),t.exports=new n},"homepage.js":function(e,t,i){var s,n;jQuery,s=i("../../../models/wizard"),n=i("../../base").extend({initialize:function(){var t=this;this.state=s.homepageState,this.state.reset(!0),this.state.on("change",function(){t.render()}),TTD.utils.add_action("wizard.previous_click",function(e){t.isActive()&&"splash"!==t.state.get("step")&&(t.state.restoreWizardData(),t.state.reset(),t.parent.loadPreview(),e.preventDefault())}),TTD.utils.add_action("wizard.model.complete.homepage",function(e){t.state.clearWizardData(),e.setStepData(t.state.data().saveData,!0,!0)}),TTD.utils.add_filter("wizard.selector.action",function(e){return t.isActive()&&"page"===t.state.get("type")&&(e="toggleDropdown"),e}),TTD.utils.add_filter("wizard.preview_template_title",function(e){return t.isActive()&&"page"===t.state.get("type")&&(e=t.state.get("page_title")||"Choose Page"),e}),TTD.utils.add_filter("wizard.can_continue",function(e){return t.isActive()&&(e=t.state.data().canContinue),e}),s.on("dropdown-selection",this.previewPage.bind(this)),s.on("after-top-render",function(e){t.isActive()&&s.isStepCompleted()&&(s.hasStepChanges()||e.$("#template-selector").append(TTD.utils.tpl("dashboard/main/wizard/homepage/edit-page")({wizard:s,homepage:t})))})},after_render:function(){if(this.state.isSplash()){var e=TTD.utils.tpl("dashboard/main/wizard/homepage/".concat(this.state.get("step")));this.$el.append(e({wizard:s,state:this.state}))}s.trigger("render-top-bar"),TTD.objects.wizardView.contentClass()},typeClicked:function(e,t){var i=t.dataset.type;return this.$(t).siblings().removeClass("selected"),this.selectType(i),!1},isActive:function(){return"homepage"===s.get("active")},selectType:function(e){switch(this.state.set({type:e,step:"option-"+e},{silent:"blog"===e}),s.setStepData({type:e}),s.trigger("render-top-bar"),e){case"page":this.state.get("page_id")&&this.parent.loadPreview();break;case"blog":this.parent.loadPreview();break;case"template":s.loadStepTemplates().then(function(e){TTD.objects.wizardView.previewTemplate(e[0]&&e[0].id,!1)})}},previewPage:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{id:"",label:"",url:"",lp:!1};this.state.set({page_id:e.id,page_title:e.label,page_url:e.url,is_landing_page:e.lp}),this.parent.loadPreview()}}),t.exports=new n({preventRender:!0})},hooks:{"actions.js":function(e,t,i){t.exports={}},"filters.js":function(e,t,i){var s=i("../../../../models/wizard");t.exports={"thrive_theme.wizard_preview_template_id":function(e){var t=s.get("active");if(TTD.utils.isWooStep(t)&&!e){var i=t.replace("woo_","");e=s.deepGet("settings.".concat(i,".template_id"))}return String(e||"")}}}},"logo.js":function(e,t,i){var s,n,a,o;jQuery,s="dark",n=TTD.CONST.branding.logo_data[s],a=i("../../../models/logo"),o=i("../../sidebar/branding/logo/item").extend({template:"dashboard/main/wizard/overlay-logo",wizard:i("../../../models/wizard"),saveLogo:function(e,t){this.$(".logo-button").css("background-image","url("+t+")"),this.model.set({attachment_id:e,src:t},{silent:!0})},loaderTarget:function(){return this.$(".logo-button")},before_render:function(){n.attachment_id===this.model.get("attachment_id")&&n.src===this.model.get("src")||this.model.set({attachment_id:n.attachment_id,src:n.src},{silent:!0})},nextStep:function(){return this.parent.loading(),n.attachment_id=this.model.get("attachment_id"),n.src=this.model.get("src"),this.wizard.setStepData(_defineProperty({},"".concat(s,"_id"),this.model.get("attachment_id")),!0).completeStep(!1),!1}}),t.exports=new o({model:new a({type:s})})},"menu.js":function(e,t,i){var s;jQuery,s=i("../../base").extend({id:"#ttd-wizard-menu",model:i("../../../models/wizard"),className:"ttd-wizard-menu ttd-d-flex",template:"dashboard/main/wizard/menu",after_initialize:function(){this.menus=[].concat(_toConsumableArray(TTD.CONST.menus),[{id:-1,name:"I will choose later...",extra_class:" choose-later"}])},getSelectedMenus:function(){var e={id:0,name:"Choose a WordPress Menu"},t=this.model.deepGet("settings.menu")||{};return{header:_.find(this.menus,function(e){return e.id===t.header})||e,footer:_.find(this.menus,function(e){return e.id===t.footer})||e}},before_render:function(){this.activeMenus=this.getSelectedMenus()},toggleDropdown:function(e){e.currentTarget.classList.toggle("dropdown-visible")},selectItem:function(e){var t=e.currentTarget;this.$('.selected-menu[data-target="'.concat(t.dataset.target,'"]')).attr("data-id",t.dataset.id).html(t.innerHTML),this.activeMenus[t.dataset.target]={id:t.dataset.id,name:t.innerHTML}},finishMenu:function(e){return"1"===e.currentTarget.dataset.templates&&(this.activeMenus.header.id=this.activeMenus.footer.id=0),this.parent.loading(),this.model.setStepData({header:this.activeMenus.header.id||0,footer:this.activeMenus.footer.id||0}),this.model.completeStep(!1),!1}}),t.exports=new s({preventRender:!0})},"top.js":function(e,t,i){var a,s,n,o;a=jQuery,s=i("../../base"),n=i("../../modals/wizard/templates"),o=s.extend({template:"dashboard/main/wizard/top",structureModals:[],events:function(){return _objectSpread({},Object.getPrototypeOf(o.prototype).events,{"mousedown .ttd-wizard-selector *":function(){return!1}})},setModel:function(e){return this.model||(this.model=e,this.model.on("step-change",this.render.bind(this)),this.model.on("template-selected",this.render.bind(this)),this.model.on("render-top-bar",this.render.bind(this))),this},previousClick:function(e){TTD.utils.do_action("wizard.previous_click",e),e.isDefaultPrevented()||(this.parent.hideTooltip(!0),this.model.previous())},render:function(){return this.model.hasTopBar()?s.prototype.render.apply(this,arguments):(this.$el.html(""),this)},after_render:function(){var s=this;if(this.model.hasTopBar()){var i=this.$("#d-search");this.__suggest=TTD.CONST.wizard.suggest_pages.map(function(e){return _objectSpread({},e)}),this.offset=0,this.limit=Math.max(this.__suggest.length,5),this.search="",this.$("#d-search").autocomplete({delay:200,minLength:0,appendTo:".d-results-holder",source:function(t,i){s.fetchPages({search:t.term}).done(function(e){s.search=t.term,s.offset=0,s.__suggest=e,i(e)})}});var t=this.$widget=i.autocomplete("instance"),n=String(this.model.getPreviewTemplateId());t._renderItem=function(e,t){var i=String(t.value)===n;return a('<li class="ui-menu-item"></li>').toggleClass("lp",t.lp).toggleClass("ttd-selected",i).append(t.label).append(t.lp?s.landingPageIcon():"").append(i?TTD.utils.icon("check_light"):"").appendTo(e)},i.on("focus",function(e){e.currentTarget.value||t._suggest(s.__suggest)}).on("autocompleteclose",this.hideDropdown.bind(this)).on("autocompletefocus autocompleteselect",function(e,t){return"mouseenter"!==e.originalEvent.originalEvent.type&&(e.currentTarget.value=t.item.label),"autocompleteselect"===e.type&&(requestAnimationFrame(function(){return i.trigger("autocompleteclose")}),s.model.trigger("dropdown-selection",t.item,s)),!1}),requestAnimationFrame(function(){return i.focus()}),this.model.trigger("after-top-render",this)}},hideDropdown:function(e){e&&e.view&&this.$("#ttd-wizard-page-selector").hide()},toggleDropdown:function(){return this.$("#ttd-wizard-page-selector").toggle().css("width",this.$(".selector-drop").outerWidth()).find("#d-search").focus(),!1},fetchPages:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e=_objectSpread({search:this.search,limit:this.limit,offset:this.offset},e||{}),TTD.utils.sendApiRequest("wizard/pages",e,"GET").done(function(e){return t.$(".d-load-more").removeClass("ui-loading").toggle(e.length>=t.limit)})},loadMore:function(){var t=this;return this.$(".d-load-more").addClass("ui-loading"),this.fetchPages({offset:this.offset+this.limit}).then(function(e){t.offset+=e.length,t.__suggest=t.__suggest.concat(e),t.$widget._suggest(t.__suggest)}),!1},openModal:function(e){var t=this.model.get("active");void 0===this.structureModals[t]&&(this.structureModals[t]=new n({model:this.model})),this.structureModals[t].open()},selectorClick:function(){var e=TTD.utils.apply_filters("wizard.selector.action","openModal");return"function"==typeof this[e]&&this[e].apply(this,arguments),!1},getEditLink:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tar";if("tar"===e)return TTD.CONST.wizard.urls.homepage_architect;if("ttb"===e&&TTD.objects.wizardView.iframeData){var t=TTD.objects.collections.templates.findWhere({ID:Number(TTD.objects.wizardView.iframeData.templateId)});return t&&t.get("edit_url")||""}return""},landingPageIcon:function(){return'<span title="Architect Landing Page" class="lp-icon"><img src="'.concat(TTD.CONST.architect_url,'editor/css/images/admin-bar-logo.png" width="16" height="16"></span>')}}),t.exports=new o({preventRender:!0})},woo:{"header-footer.js":function(e,t,i){var s;jQuery,s=i("../../../base").extend({template:"dashboard/main/wizard/woo/header-footer",model:i("../../../../models/wizard"),before_initialize:function(){var s=this,n=[];TTD.utils.add_action("theme.wizard.select_template",function(e){var t=s.model.get("active"),i="woo_"+t;"header"!==t&&"footer"!==t||!n[i]||(n[i].hasPreview=!1)}),TTD.utils.add_action("theme.wizard.build_preview",function(e){var t=s.model.get("active");if(TTD.utils.isWooStep(t)){var i=s.model.deepGet("settings.".concat(s.type));n[t]=e,i&&e.$templatesList.find("[data-id=".concat(i.template_id,"]")).addClass("ttd-hf-default-template").find(".tpl-title-container").append('<span class="tpl-title mb-5 tpl-use-default">Use my default '.concat(s.type,"</span>"))}}),this.model.on("step-change",function(e,t){var i=t.id;TTD.utils.isWooStep(i)&&(s.model.get("done").find(function(e){return e===i})||s.model.setStepData({template_id:""},!0,!0,i))})},setType:function(e){return this.type=e.replace("woo_",""),this},chooseDefault:function(){this.parent.loading(),this.model.setStepData(this.model.deepGet("settings.".concat(this.type))),this.model.completeStep(!1)}}),t.exports=new s({preventRender:!0})}},"woo.js":function(e,t,i){var s;jQuery,s=i("../../base").extend({id:"#ttd-wizard-woo",model:i("../../../models/wizard"),className:"ttd-wizard-woo ttd-d-flex",template:"dashboard/main/wizard/woo",after_initialize:function(){var i=this;this.hasTemplates=TTD.CONST.woocommerce.has_templates,this.shopUrl=TTD.CONST.woocommerce.shop_url,this.model.on("complete-step-done",function(e,t){i.hasTemplates=t,i.templatesDownloaded&&t?i.render():i.templatesDownloaded=!1,i.parent.loading(!1)})},downloadTemplates:function(){this.parent.loading(),this.templatesDownloaded=!0,this.model.completeStep(!1,!0)}}),t.exports=new s({preventRender:!0})}},"wizard.js":function(e,t,a){jQuery,t.exports=a("../base").extend({template:"dashboard/main/wizard",popupCoords:{top:0,left:"50%"},before_initialize:function(e){var i=this;(window.TTD.objects.wizardView=this).top=a("./wizard/top"),e.model=this.model=a("../../models/wizard"),this.top.setModel(e.model),this.homepage=a("./wizard/homepage"),this.top.parent=this.homepage.parent=this,this.hooks(),this.model.on("step-change",this.onStepChange.bind(this)),this.model.on("finished",function(){i.loadPreview()}),TTD.Elements.$body.removeClass("ttd-init"),this.model.on("templates-loaded",function(e){if("homepage"!==i.model.get("active")&&e.length){var t=TTD.utils.apply_filters("thrive_theme.wizard_preview_template_id",i.model.getPreviewTemplateId())||e[0].id;i.previewTemplate(t,!1)}}),TTD.utils.add_action("theme.document.keyup",this.onKeyup.bind(this))},after_initialize:function(){this.loadPreview()},after_render:function(){this.$dom={wrapper:this.$(".ttd-wizard-content"),frame:this.$("#wizard-frame"),container:this.$(".ttd-wizard-frame-container"),welcome:this.$(".ttd-wizard-welcome"),overlay:this.$(".ttd-wizard-frame-overlay"),nav:this.$(".ttd-template-nav")},this.top.setElement(this.$("#ttd-wizard-top")),this.top.render()},hooks:function(){_.each(a("./wizard/hooks/actions"),function(e,t){return TTD.utils.add_action(t,e)}),_.each(a("./wizard/hooks/filters"),function(e,t){return TTD.utils.add_filter(t,e)})},start:function(){return this.model.start(),!1},onStepChange:function(e,t){this.$dom.wrapper.removeClass(function(e,t){return t.split(" ").filter(function(e){return 0===e.indexOf("step-")}).join(" ")}).addClass("step-".concat(e.id)),t&&t.id!==e.id&&this.$dom.overlay.empty(),this.loadPreview()},loadPreview:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.model.getFrameURL(),i=this.$dom.frame.attr("src");i&&(i=i.replace(/(\\?|&)_=(\d+)$/,"",t)),t&&i!==t?(t=TTD.utils.addUrlParam(t,"_",String((new Date).getTime())),this.$dom.nav.hide(),this.loading(),this.$dom.frame.attr("src",t).one("load",function(){setTimeout(e.loading.bind(e,!1),300)})):this.buildOverlay()},buildOverlay:function(){if(this.iframeData){this.top.render(),this.$dom.overlay.empty();var e=this.getStepOverlay();e instanceof Backbone.View?(e.setElement(this.$dom.overlay),e.parent=this,e.render()):this.$dom.overlay.html(e).toggle(!!e),!this.model.isStepCompleted()&&this.model.getPreviewTemplateId()?this.$dom.nav.show().filter(".btn-prev").toggleClass("disabled",!this.model.hasPrevTemplate()).end().filter(".btn-next").toggleClass("disabled",!this.model.hasNextTemplate()):this.$dom.nav.hide(),this.showTooltip(),this.contentClass()}},loading:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.$dom.wrapper.toggleClass("ttd-loading loader-absolute",e)},getStepOverlay:function(){var e;if(this.$dom.overlay.removeAttr("style"),this.model.isStarted())if(this.model.isFinished())e="dashboard/main/wizard/overlay-finished";else{var t=this.model.getCurrentStep();t||(t=this.model.getNextAvailableStep(),this.model.set({active:t.id,activeIndex:this.model.getNextAvailableStepIndex()},{silent:!0}));var i=t.id;e="";var s="calc(50% + ".concat(this.iframeData.headerHeight/2,"px)"),n=(this.iframeData.scrollWidth||0)+"px";switch(this.popupCoords.top="".concat(this.iframeData.headerHeight+50,"px"),i){case"logo":e=a("./wizard/logo");break;case"color":e=a("./wizard/color");break;case"header":case"woo_header":this.$dom.overlay.css("margin-top",this.iframeData.headerHeight),s="".concat(this.iframeData.headerHeight/2,"px"),i.includes("woo")&&(e=a("./wizard/woo/header-footer").setType(i));break;case"footer":case"woo_footer":this.$dom.overlay.css("bottom",this.iframeData.footerHeight+"px"),s="calc(100% - ".concat(this.iframeData.footerHeight/2,"px)"),this.popupCoords.top="calc(100% - ".concat(this.iframeData.footerHeight+250,"px)"),i.includes("woo")&&(e=a("./wizard/woo/header-footer").setType(i));break;case"homepage":this.model.isStepCompleted()||(e=a("./wizard/homepage"));break;case"menu":e=a("./wizard/menu");break;case"woo":e=a("./wizard/woo")}this.$dom.nav.css({top:s}).filter(".btn-next").css({right:n})}else e="dashboard/main/wizard/overlay-welcome";return!e||e instanceof Backbone.View||(e=TTD.utils.tpl(e)({view:this,data:this.iframeData,wizard:this.model})),e},clickSaveTemplate:function(){this.hideTooltip(),this.model.completeStep()},nextTemplate:function(){return this.homepage.isActive()&&"page"===this.model.homepageState.get("type")&&this.iframeData.nextPage?this.homepage.previewPage(this.iframeData.nextPage):(this.model.hasNextTemplate()&&this.previewTemplate(this.model.getAdjacentTemplateId("next")),!1)},prevTemplate:function(){return this.homepage.isActive()&&"page"===this.model.homepageState.get("type")&&this.iframeData.prevPage?this.homepage.previewPage(this.iframeData.prevPage):(this.model.hasPrevTemplate()&&this.previewTemplate(this.model.getAdjacentTemplateId("prev")),!1)},onKeyup:function(e){switch(e.which){case 37:this.prevTemplate();break;case 39:this.nextTemplate()}},hideTooltip:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.$("#ttd-step-tooltip");e?(t.addClass("ttd-out"),setTimeout(function(){return t.removeClass("ttd-visible ttd-out")},1e3)):t.removeClass("ttd-visible")},showTooltip:function(){this.hideTooltip();var e=this.model.getPopupMessage();if((!this.lastHoveredElement||!this.lastHoveredElement.closest("#template-selector"))&&e&&!TTD.CONST.dismissed_tooltips.includes("wizard-select")){var t=this.top.$(".selector-btn");this.$("#ttd-step-tooltip").addClass("ttd-visible").css({right:"".concat((t.outerWidth()||0)+15,"px")}).find(".tt-message").html(e)}},tooltipNeverShow:function(){return this.hideTooltip(!0),TTD.CONST.dismissed_tooltips=Array.from(new Set(TTD.CONST.dismissed_tooltips.concat("wizard-select"))),TTD.utils.sendApiRequest("options/user-option",{meta_key:"ttb_dismissed_tooltips",meta_value:TTD.CONST.dismissed_tooltips.filter(function(e){return e})}),!1},dismissTooltipOnMouseenter:function(){this.hideTooltip(!0)},previewTemplate:function(e){var t=this,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(!this.templateLoading){if(void 0===this.iframeAPI)return setTimeout(this.previewTemplate.bind(this,e,i),200);var s=this.model.getStepKey("previewMode");this.templateLoading=!0,this.$(".template-loading").addClass("ttd-loading"),"iframe"!==s&&this.iframeAPI.getPreviewElement().addClass("ttb-loading"),this.model.selectTemplate(e).then(function(e){delete t.templateLoading,i&&t.hideTooltip(),"iframe"!==s&&t.iframeAPI.inlinePreview(e)})}},homepageChangeOption:function(e){var t=this;this.homepage.selectType(e.currentTarget.value),"page"===e.currentTarget.value&&setTimeout(function(){return t.$(".selector-drop").click()})},contentClass:function(){var e=this.model.get("active"),t="";this.model.isFinished()&&(e="finished"),"homepage"===e&&(t=" home--"+this.model.homepageState.get("step")),this.$dom.wrapper.removeClass(function(e,t){return t.split(" ").filter(function(e){return e.startsWith("step-")||e.startsWith("home--")}).join(" ")}).addClass("step-".concat(e||"welcome").concat(t))},recordMouseOver:function(e){this.lastHoveredElement=e.target}})}},modals:{"base.js":function(e,t,i){var s;s=jQuery,t.exports=i("../base").extend({before_initialize:function(e){var t=this;TTD.utils.add_action("theme.document.keyup",function(e){27===e.keyCode&&t.is_open()&&t.close()}),TTD.utils.add_action("theme.document.click",function(e){e.target.classList.contains("ttd-modal")&&e.target.classList.contains("active")&&t.close()}),TTD.utils.add_action("theme.document.keyup",function(e){t.is_open()&&13===e.keyCode&&t.on_enter()})},on_enter:function(){},open:function(e){"function"==typeof this.before_open&&this.before_open(e),TTD.Elements.$body.addClass("ttd-modal-visible"),this.$el.addClass("active"),"function"==typeof this.after_open&&this.after_open(e)},close:function(e){return TTD.Elements.$body.removeClass("ttd-modal-visible"),this.$el.removeClass("active"),"function"==typeof this.after_close&&this.after_close(e),this.$content.removeClass("ttd-loading small"),this},is_open:function(){return this.$el.hasClass("active")},validate:function(){return!0},render:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return"function"==typeof this.before_render&&this.before_render(e),this.template&&_.isString(this.template)&&(this.template=TTD.utils.tpl(this.template)),this.template&&(this.setElement(s(TTD.utils.tpl("dashboard/modals/base")()).appendTo(TTD.Elements.$modals)),this.$(".modal-inner").html(this.template(e)),e.type&&"small"===e.type&&this.$el.closest(".ttd-modal").addClass("ttd-modal-small")),this.$content=this.$(".modal-content"),"function"==typeof this.after_render&&this.after_render(e),this}})},skins:{cloud:{"item.js":function(e,t,i){var n,s,a;n=jQuery,s=i("../../../base"),a=i("../../../../models/skin"),t.exports=s.extend({tagName:"div",template:"dashboard/modals/skins/cloud/item",className:"ttd-cloud-skin-item-container",after_render:function(){this.$new_skin_view=TTD.objects.modals.new_skin,this.$el.attr("data-id",this.model.get("id"))},skin_import_step:function(e,t){var s=this,i=this.$el.attr("data-id");this.$el.addClass("ttd-loading "),n.ajax({url:TTD.CONST.routes.skins+"/cloud_import",type:"POST",data:{skin_id:i},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).success(function(e){var t="Theme <b>imported</b> successfully!",i="success";if("string"==typeof e)t=e,i="error";else{var s=new a(e,{parse:!0});s.is_active()&&TTD.utils.reloadDashboard(),TTD.objects.collections.skins.add(s,{at:0})}TTD.utils.message(t,i)}).error(function(e,t,i){s.error(e,t,i)}).always(function(){s.$el.removeClass("ttd-loading "),s.$new_skin_view.close()})},step_data:function(e){this.$new_skin_view.$("#cloud-skin-name").val(this.model.get("name")),this.$new_skin_view.$(".ttd-down-skin-name").html(this.model.get("name")),this.$new_skin_view.$(".ttd-down-skin-img").css("background-image","url('"+this.model.get("thumb")+"')"),this.$new_skin_view.$("input.archive_path").val(e)}})},"list.js":function(e,t,i){var s,n,a;jQuery,s=i("../../../base"),n=i("../../../../collections/skins"),a=i("./item"),t.exports=s.extend({className:"ttd-cloud-skins-listing",template:"dashboard/modals/skins/cloud/list",after_render:function(){void 0===TTD.objects.collections.cloud_skins&&(TTD.objects.collections.cloud_skins=new n(TTD.CONST.cloud_skins)),this.collection=TTD.objects.collections.cloud_skins,this.listenTo(this.collection,"sort",this.render_list.bind(this)),this.collection.sort(),TTD.utils.init_scrollbar(this.$(".ttd-cloud-skin-scroll"))},render_list:function(e){var i=this.$(".ttd-cloud-skins-list").empty();(e||this.collection).each(function(e){var t=new a({model:e});i.append(t.$el)})}})},"main.js":function(e,t,i){var s,n;jQuery,s=i("../../../base"),n=i("./list"),t.exports=s.extend({template:"dashboard/modals/skins/cloud/main",after_render:function(){this.$cloud_skins=new n,this.$(".cloud-items-content").append(this.$cloud_skins.$el),this.set_cloud_items_number(this.$cloud_skins.collection.length)},set_cloud_items_number:function(e){this.$(".cloud-items-counter").html(e)},search_cloud_skins:function(e){var t=TTD.objects.collections.cloud_skins.byName(e.currentTarget.value);this.$cloud_skins.render_list(t),this.set_cloud_items_number(t.length)}})}},"create.js":function(e,t,i){var n,s,a;n=jQuery,s=i("../../../models/skin"),a=i("./cloud/main"),t.exports=i("../base").extend({template:"dashboard/modals/skins/create",before_open:function(e){var t=e.step?e.step:"first";this.collection=e.collection,this.before_step(t),this.display_step(t),this.init_import()},init_import:function(){var t=this,i=this;this.import_skin_frame=wp.media.frames.file_frame=wp.media({title:"Import Theme",button:{text:"Import"},multiple:!1,frame:"select",library:{type:"application/zip"}}),this.import_skin_frame.on("select",function(){t.content().addClass("ttd-loading");var e=i.import_skin_frame.state().get("selection").first().toJSON();if("application/zip"!==e.mime)return alert("Only .zip files are allowed"),t.content().removeClass("ttd-loading"),void i.import_skin_frame.open();t.import_skin({attachment_id:e.id})})},import_skin:function(e){var i=this;n.ajax({url:TTD.CONST.routes.skins+"/import",type:"POST",data:e,headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){var t=new s(e,{parse:!0});t.is_active()&&TTD.utils.reloadDashboard(),TTD.objects.collections.skins.add(t,{at:0}),TTD.utils.message("Theme <b>imported</b> successfully!","success")}).error(function(e,t){i.error({},e,t)}).always(function(){i.close(),TTD.Elements.$body.removeClass("ttd-loading "),i.$content.removeClass("ttd-loading small")})},select_skin:function(e){n(e.currentTarget).addClass("active").siblings().each(function(e,t){t.classList.remove("active")})},step:function(e,t){this.before_step(t.dataset.step),this.display_step(t.dataset.step)},before_step:function(e){switch(e){case"first":this.$el.removeClass("cloud-items cloud-download");break;case"blank":this.$(".step input").val(""),this.focus_on_input();break;case"cloud-items":this.focus_on_input(),this.$el.addClass("cloud-items").removeClass("cloud-download"),this.cloud=new a({el:this.$(".cloud-items-container")[0]});break;case"cloud-import-download":this.focus_on_input(),this.$el.removeClass("cloud-items").addClass("cloud-download")}},focus_on_input:function(){var e=this;setTimeout(function(){e.$(".step:visible input").trigger("focus")},100)},display_step:function(e){this.$(".ttd-error-message").hide(),this.$(".step").hide(),this.$step=this.$("."+e+"-step").show()},skin_save:function(){var e=this.get_input_name();if(e){var t=new s({name:e});this.save(t)}},get_input_name:function(){var e=this.$("#skin-name").val();return e&&0!==e.length?e:(this.$(".blank-step .ttd-error-message").show(),this.$("#skin-name").trigger("focus"),!1)},save:function(e,t){var s=this;t=n.extend({},t,{}),this.$content.addClass("ttd-loading small"),e.save(t,{wait:!0,success:function(e){s.collection.add(e,{at:0}),s.close(),TTD.utils.message("Theme <b>created</b> successfully!","success")},error:function(e,t,i){s.close(),s.error(e,t,i)}})},keyup:function(e){this.$(".ttd-error-message").hide(),13===e.keyCode&&this.$step.find(".click.normal-button").trigger("click")},import:function(){this.import_skin_frame.open()},content:function(){return this.$content||(this.$content=this.$(".modal-content"))}})},"delete.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/modals/skins/delete",model:null,after_open:function(e){this.model=e.model,this.$(".ttd-delete-skin-name").html("<b>"+this.model.get("name")+"</b>")},delete:function(){var s=this;this.$content.find(".red").addClass("ttd-button-loading"),this.model.destroy({processData:!0,data:{force:!0},wait:!0,success:function(){s.$content.find(".red").removeClass("ttd-button-loading"),s.close(),TTD.utils.message("Theme <b>deleted</b>.","success")},error:function(e,t,i){s.error(e,t,i)}})},on_enter:function(){this.delete()}})},"export.js":function(e,t,i){var s,n;s=jQuery,n=i("../base"),t.exports=n.extend({template:"dashboard/modals/skins/export",model:null,export_ids:[],before_initialize:function(t){n.prototype.before_initialize.apply(this,arguments),this.model=new Backbone.Model,this.model.set("skin_id",t.ID),this.model.set("name",TTD.objects.collections.skins.find(function(e){return e.get("term_id")===t.ID}).get("name"))},before_open:function(){this.$("#export-archive-name").val(this.model.get("name"))},export:function(){var e=this;this.model.get("skin_id")?this.model.get("name")?(this.content().addClass("ttd-loading"),s.ajax({url:TTD.CONST.routes.skins+"/export",type:"POST",data:{name:this.model.get("name"),skin_id:this.model.get("skin_id")},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){window.location.assign(e)}).error(function(){TTD.utils.message("Error exporting theme!","error",5e3)}).always(function(){e.close(),e.content().removeClass("ttd-loading"),TTD.Elements.$body.removeClass("ttd-loading ")})):TTD.utils.message("Please fill in a name for the archive!","error",3e3):TTD.utils.message("Error: No theme selected!","error",3e3)},keyup:function(e){this.model.set("name",this.$("#export-archive-name").val())},on_enter:function(){this.export()},content:function(){return this.$content||(this.$content=this.$(".modal-content"))}})}},templates:{create:{"create-homepage.js":function(e,t,i){var s=i("../../../../views/select");t.exports=i("../../base").extend({template:"dashboard/modals/templates/create-homepage",after_render:function(){this.$errorMessage=this.$(".ttd-error-message"),this.$templateName=this.$("#homepage-template-name"),this.inheritSelect=new s({el:this.$(".ttd-template-inherit")[0],model:new Backbone.Model({list:this.getInheritFromTemplates(),label:"Copy existing template",default:"default"})})},before_open:function(){this.$templateName.val(""),this.inheritSelect.model.set("list",this.getInheritFromTemplates())},getInheritFromTemplates:function(){return TTD.objects.collections.templates.prepareTemplatesForSelect(function(e){return"page"===TTD.utils.homepageType()?e.isSingular():e.isList()},this.getMetaOptions())},after_open:function(){var e=this;setTimeout(function(){e.$templateName.focus()},100)},after_close:function(){this.$templateName.removeClass("ttd-error-input"),this.$errorMessage.hide()},keyup:function(e){13===e.which&&this.save()},getMetaOptions:function(){return{primary_template:"home",secondary_template:TTD.utils.homepageType()}},save:function(){var i=this,e=this.$templateName.val();if(!e)return this.$templateName.addClass("ttd-error-input"),void this.$errorMessage.show();var t={inherit_from:this.inheritSelect.get_value()};t.inherit_from&&"default"!==t.inherit_from&&(t.thumbnail=TTD.objects.collections.templates.get(t.inherit_from).get("thumbnail"));var s=TTD.utils.templateModelFactory({meta_input:this.getMetaOptions(),post_title:e});this.$content.addClass("ttd-loading small"),s.save(t,{wait:!0,success:function(e,t){i.$content.removeClass("ttd-loading small"),i.close(),e.set("just_added",1),TTD.objects.collections.templates.remove(0),TTD.objects.collections.templates.add(e),TTD.CONST.templates.push(t),TTD.utils.message("Template <b>created</b> successfully!","success")},error:function(){TTD.utils.message("Error creating template!","error")}})}})},"create.js":function(e,t,i){var s=i("./single"),n=i("./list");t.exports=i("../../base").extend({template:"dashboard/modals/templates/create-page",after_initialize:function(){this.$templateName=this.$("#template-name"),this.$singleViewOptions=new s({el:this.$(".select-single-container")[0]}),this.$listViewOptions=new n({el:this.$(".select-list-container")[0]})},after_render:function(){this.$primaryBtns=this.$(".ttd-modal-sol"),this.$input=this.$("#template-name"),this.$errorMessage=this.$(".ttd-error-message")},before_open:function(){this.$templateName.val(""),this["$".concat(this.$primaryBtns.find(".active").attr("data-primary"),"ViewOptions")].renderInheritSelect()},after_open:function(){var e=this;setTimeout(function(){e.$templateName.focus()},100)},after_close:function(){this.$input.removeClass("ttd-error-input"),this.$errorMessage.hide()},keyup:function(e){13===e.which&&this.save()},save:function(){var i=this,e=this.$templateName.val();if(!e)return this.$input.addClass("ttd-error-input"),void this.$errorMessage.show();var t,s={post_title:e},n="single"===this.$primaryBtns.find(".active").attr("data-primary")?this.$singleViewOptions:this.$listViewOptions;s.meta_input=n.getCreateOptions(),t=n.getExtra(),this.$content.addClass("ttd-loading small"),TTD.utils.templateModelFactory(s).save(t,{wait:!0,success:function(e,t){i.$content.removeClass("ttd-loading small"),i.close(),e.set("just_added",1),TTD.objects.collections.templates.add(e),TTD.CONST.templates.push(t),TTD.utils.message("Template <b>created</b> successfully!","success")},error:function(){TTD.utils.message("Error creating template!","error")}})},singleOrList:function(e,t){Array.from(t.parentElement.children).forEach(function(e){return e.classList.remove("active")}),t.classList.add("active"),this.$listViewOptions.$el.toggle("list"===t.dataset.primary),this.$singleViewOptions.$el.toggle("single"===t.dataset.primary),this["$".concat(t.dataset.primary,"ViewOptions")].beforeShow()}})},"list.js":function(e,t,i){var n=i("../../../select");t.exports=i("../../../base").extend({after_initialize:function(){this.renderListSelect()},beforeShow:function(){},renderListSelect:function(){var t=this;this.deleteSelect(this.primarySelect),this.primarySelect=new n({el:this.$(".ttd-template-primary")[0],model:{list:TTD.CONST.list_templates,label:"List Type:",default:TTD.CONST.list_templates.length?TTD.CONST.list_templates[0].key:""},on_select:function(e){"blog"===e||"archive"===e?t.renderCustomArchiveSelect(_.findWhere(TTD.CONST.list_templates,{key:e})):(t.deleteSelect(t.secondarySelect),t.deleteSelect(t.variableSelect)),t.renderInheritSelect()}}),this.renderCustomArchiveSelect(_.findWhere(TTD.CONST.list_templates,{key:"blog"})),this.renderInheritSelect()},renderInheritSelect:function(){var e=TTD.objects.collections.templates.prepareTemplatesForSelect(function(e){return e.isList()},this.getCreateOptions());this.deleteSelect(this.inheritSelect),this.inheritSelect=new n({el:this.$(".ttd-template-inherit")[0],model:new Backbone.Model({list:e,label:"Copy Existing Template",default:e.find(function(e){return e.inheritFrom}).key})})},renderCustomArchiveSelect:function(i){var s=this,e=this.getSecondaryList(i);this.deleteSelect(this.secondarySelect),this.deleteSelect(this.variableSelect),this.secondarySelect=new n({el:this.$(".ttd-template-secondary")[0],model:{list:e,label:"Archive Type:",default:e.length?e[0].key:""},on_select:function(e,t){i.secondary&&i.secondary[e]&&i.secondary[e].variable?s.variableSelectInit({key:e,name:t},i.secondary[e]):s.deleteSelect(s.variableSelect),s.renderInheritSelect()}})},variableSelectInit:function(e,t){var i=this.getVariableList(e.key,t);this.deleteSelect(this.variableSelect),0<i.length&&(this.variableSelect=new n({el:this.$(".ttd-template-variable").show()[0],model:{list:i,label:"Defined for:",default:i.length?i[0].key:""}}))},getSecondaryList:function(e){var i=[],t=void 0!==e.secondary?e.secondary:{};return i.push({key:0,name:"All "+e.name}),_.each(t,function(e,t){i.push({key:t,name:e.name})}),i},getVariableList:function(e,t){var i=[];return i.push({key:"0",name:"All "+t.name}),t.variable&&_.each(t.variable,function(e,t){i.push({key:t,name:e})}),i},deleteSelect:function(e){e&&(e.undelegateEvents(),e.$el.empty(),e=null)},getCreateOptions:function(){var e=this.primarySelect.get_value(),t=this.secondarySelect?this.secondarySelect.get_value():"";return"blog"===e&&("post"===t?(e="home",t="blog"):e="archive"),{primary_template:e,secondary_template:t,variable_template:this.variableSelect?this.variableSelect.get_value():"",default:0}},getExtra:function(){var e=this.inheritSelect.get_value(),t={inherit_from:e};return e&&"default"!==e&&(t.thumbnail=TTD.objects.collections.templates.get(e).get("thumbnail")),t}})},"single.js":function(e,t,i){var n=i("../../../select");t.exports=i("../../../base").extend({before_initialize:function(){var t=this;TTD.objects.collections.templates.on("add remove",function(e){e.isSingular()&&t.renderInheritSelect(),TTD.Views.Dashboard.$main.$filters.render()})},after_initialize:function(){this.renderDropdowns()},beforeShow:function(){},renderDropdowns:function(){var t=this,e=this.prepareItemsForSelect(TTD.CONST.post_formats),i=_objectSpread({},TTD.CONST.content_types,{error404:{key:"error404",name:" 404 Page"}});TTD.utils.isHomeLandingPage()||"posts"===TTD.CONST.options.show_on_front||(i.home={key:"home",name:"Homepage"}),TTD.CONST.woocommerce.is_active&&delete i[TTD.CONST.woocommerce.key],this.postFormatSelect=this.renderSelect(".ttd-template-post-format",e,"Choose Post Format",function(){t.renderInheritSelect()}),this.contentTypeSelect=this.renderSelect(".ttd-template-content-type",i,"Choose Content Type",function(e){t.postFormatSelect.$el.toggle("post"===e),t.renderInheritSelect()}),this.renderInheritSelect()},renderInheritSelect:function(){var e=TTD.objects.collections.templates.prepareTemplatesForSelect(function(e){return!e.isList()},this.getCreateOptions());this.inheritSelect&&this.inheritSelect.undelegateEvents(),this.inheritSelect=new n({el:this.$(".ttd-template-inherit")[0],model:new Backbone.Model({list:e,label:"Copy Existing Template",default:e.find(function(e){return e.inheritFrom}).key})})},prepareItemsForSelect:function(e){return e.map(function(e){return{key:e,name:TTD.utils.capitalize(e)}})},renderSelect:function(e,t,i){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:jQuery.noop;return new n({el:this.$(e)[0],model:new Backbone.Model({list:t,label:i,default:_.isEmpty(t)?"":t[Object.keys(t)[0]].key}),on_select:s})},getCreateOptions:function(){var e=this.contentTypeSelect.get_value(),t={primary_template:"singular",secondary_template:e,default:0};switch(e){case"post":t.format=this.postFormatSelect.get_value();break;case"error404":t.primary_template=e,t.secondary_template="";break;case"home":t.primary_template="home",t.secondary_template="page"}return t},getExtra:function(){var e=this.inheritSelect.get_value(),t={inherit_from:e};return e&&"default"!==e&&(t.thumbnail=TTD.objects.collections.templates.get(e).get("thumbnail")),t}})}},"delete.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/modals/templates/delete",model:null,after_open:function(e){this.model=e.model,this.$(".ttd-delete-template-name").html("<b>"+this.model.get("post_title")+"</b>")},delete:function(){var e=this;this.$content.addClass("ttd-loading small"),this.model.destroy({wait:!0,success:function(){e.$content.removeClass("ttd-loading small"),e.close(),TTD.utils.message("Template <b>deleted</b>.","success")}})},on_enter:function(){this.delete()}})},"export.js":function(e,t,i){var s,n,a;s=jQuery,n=i("./item-views/template-group"),a=i("./item-views/template-item"),t.exports=i("../base").extend({template:"dashboard/modals/templates/export",model:null,export_ids:[],before_open:function(){this.model=new Backbone.Model,this.$("#export-archive-name").val(""),this.render_list()},render_list:function(){var i=this;this.$(".ttd-templates-groups-list").empty(),this.$(".ttd-template-items-list").empty(),_.each(TTD.objects.collections,function(e,t){"skins"!=t&&i.render_group(t,e)})},render_group:function(e,t){var i=this;t.key=e;var s=new n({model:t,export_ids:this.export_ids});this.$(".ttd-templates-groups-list").append(s.$el),_.each(t.models,function(e,t){i.render_template_item(t,e,s)})},render_template_item:function(e,t,i){var s=new a({model:t,export_ids:this.export_ids});i.$(".ttd-template-items-list").append(s.$el)},export:function(){var e=this;this.model.get("name")?this.export_ids.length?(TTD.Elements.$body.addClass("ttd-loading "),s.ajax({url:TTD.CONST.routes.templates+"/export",type:"POST",data:{templates:e.export_ids,name:e.model.get("name")},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){window.location.assign(e)}).error(function(){TTD.utils.message("Error exporting templates!","error",5e3)}).always(function(){e.close(),TTD.Elements.$body.removeClass("ttd-loading ")})):TTD.utils.message("No templates were selected!","error",3e3):TTD.utils.message("Please fill in a name for the archive!","error",3e3)},keyup:function(e){this.model.set("name",this.$("#export-archive-name").val())},on_enter:function(){this.export()}})},"full-reset.js":function(e,t,i){var s;s=jQuery,t.exports=i("../base").extend({template:"dashboard/modals/templates/full-reset",reset:function(){var e=this;TTD.utils.loading(),s.ajax({url:TTD.CONST.routes.templates+"/factory_reset",type:"POST",headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(){e.close(),setTimeout(function(){return location.reload()},1e3)}).error(function(){TTD.utils.message("Error resetting all templates!","error",5e3),e.close()})},on_enter:function(){this.reset()}})},"import.js":function(e,t,i){var s,n;s=jQuery,n=i("./item-views/import_item"),t.exports=i("../base").extend({template:"dashboard/modals/templates/import",import_ids:[],extra_imports:{},before_open:function(){this.render_list()},render_list:function(){var i=this;this.$(".ttd-import-templates-list").empty(),this.response.items.templates.length?(this.$(".ttd-import-templates-list-container").show(),_.each(this.response.items.templates,function(e,t){i.render_template(t,e,i.$(".ttd-import-templates-list"))})):this.$(".ttd-import-templates-list-container").hide(),this.response.items.symbols.length?(this.$(".ttd-import-symbols-list-container").show(),_.each(this.response.items.symbols,function(e,t){i.render_template(t,e,i.$(".ttd-import-symbols-list"))})):this.$(".ttd-import-symbols-list-container").hide()},render_template:function(e,t,i){var s=new n({model:t});s.import_ids=this.import_ids,i.append(s.$el)},select_all:function(e){var i=this,t=e.target.dataset.type;this.$(".ttd-import-"+t+'-list input[type="checkbox"]').each(function(e,t){t.checked=!0,-1===i.import_ids.indexOf(parseInt(t.value))&&i.import_ids.push(parseInt(t.value))})},select_none:function(e){var i=this,t=e.target.dataset.type;this.$(".ttd-import-"+t+'-list-container input[type="checkbox"]').each(function(e,t){t.checked=!1,-1!==(e=i.import_ids.indexOf(parseInt(t.value)))&&i.import_ids.splice(e,1)})},select_import_extra:function(e){this.extra_imports[e.target.value]=e.target.checked},import:function(){var e=this;this.import_ids.length?(TTD.Elements.$body.addClass("ttd-loading "),s.ajax({url:TTD.CONST.routes.templates+"/import",type:"POST",data:{extra_features:this.extra_imports,ids:this.import_ids,attachment_id:this.response.attachment_id},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){location.reload()}).error(function(){TTD.utils.message("Error importing templates!","error",5e3)}).always(function(){e.close(),TTD.Elements.$body.removeClass("ttd-loading ")})):TTD.utils.message("No templates were selected!","error",3e3)},on_enter:function(){this.import()}})},"item-views":{"import_item.js":function(e,t,i){jQuery,t.exports=i("../../../base").extend({tagName:"div",className:"ttd-import-item",template:"dashboard/modals/templates/item-views/import-item",select_import_template:function(e){var t=this.import_ids.indexOf(this.model.ID);e.target.checked&&-1===t?this.import_ids.push(this.model.ID):e.target.checked||-1===t||this.import_ids.splice(t,1)}})},"import_preview.js":function(e,t,i){var s,n;s=jQuery,n=i("../import"),t.exports=i("../../../base").extend({template:"dashboard/modals/templates/import",initialize:function(){var t=this;TTD.objects.modals.import_modal=new n({type:"small"}),this.import_template_frame=wp.media.frames.file_frame=wp.media({title:"Import Theme Template",button:{text:"Import"},multiple:!1,frame:"select",library:{type:"application/zip"}}),this.import_template_frame.on("select",function(){TTD.Elements.$body.addClass("ttd-loading ");var e=t.import_template_frame.state().get("selection").first().toJSON();if("application/zip"!==e.mime)return alert("Only .zip files are allowed"),TTD.Elements.$body.removeClass("ttd-loading "),void t.import_template_frame.open();s.ajax({url:TTD.CONST.routes.templates+"/import_preview",type:"POST",data:{attachment_id:e.id},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){TTD.objects.modals.import_modal.response=e,TTD.objects.modals.import_modal.open()}).error(function(){TTD.utils.message("Error importing archive!","error",5e3)}).always(function(e){TTD.Elements.$body.removeClass("ttd-loading ")})})},open:function(){this.import_template_frame.open()}})},"template-group.js":function(e,t,i){t.exports=i("../../../base").extend({tagName:"div",className:"ttd-template-group-item",template:"dashboard/modals/templates/item-views/template-group",before_initialize:function(e){this.export_ids=e.export_ids},select_group:function(s){var n=this;this.$('.ttd-template-items-list input[type="checkbox"]').each(function(e,t){t.checked=s.target.checked}),_.each(this.model.models,function(e,t){var i=n.export_ids.indexOf(e.get("ID"));s.target.checked&&-1===i?n.export_ids.push(e.get("ID")):s.target.checked||-1===i||n.export_ids.splice(i,1)})}})},"template-item.js":function(e,t,i){jQuery,t.exports=i("../../../base").extend({tagName:"div",className:"ttd-template-item",template:"dashboard/modals/templates/item-views/template-item",before_initialize:function(e){this.export_ids=e.export_ids},select_template:function(e){var t=this.export_ids.indexOf(this.model.get("ID"));e.target.checked&&-1===t?this.export_ids.push(this.model.get("ID")):e.target.checked||-1===t||this.export_ids.splice(t,1)}})}},"post-create.js":function(e,t,i){var s=i("../../../models/template"),n=i("../../select");t.exports=i("../base").extend({template:"dashboard/modals/templates/create-post",before_open:function(e){this.collection=e.collection,this.meta_input=e.meta_input||{};var t=this.meta_input.primary_template;this.beforeStep(t),this.displayStep(t),this.$(".ttd-modal-sidebar-icon").hide().filter('[data-icon="'.concat(t,'"]')).show()},displayStep:function(e){this.$(".ttd-error-message").hide(),this.$(".step").hide(),this.$step=this.$("."+e+"-step").show()},beforeStep:function(e){switch(e){case"singular":this.enablePostFormats();break;case"list":this.renderListSelect()}},step:function(e,t){this.beforeStep(t.dataset.step),this.displayStep(t.dataset.step)},singularSave:function(){var e=this.$(".post-format:checked").val();e&&this.save(new s({meta_input:_objectSpread({},this.meta_input,{format:e,default:1})}))},listTemplateSave:function(){var e=new s({meta_input:_objectSpread({},this.meta_input,{primary_template:this.primarySelect?this.primarySelect.get_value():"",secondary_template:this.secondarySelect?this.secondarySelect.get_value():"",variable_template:this.variableSelect?this.variableSelect.get_value():"",default:1})});this.save(e)},save:function(e){var t=this;e.set("post_title",e.name()),this.$content.addClass("ttd-loading small"),e.save({},{wait:!0,success:function(e){t.$content.removeClass("ttd-loading small"),t.collection.add(e),t.close(),TTD.utils.message("Template <b>created</b> successfully!","success")},error:function(){TTD.utils.message("Error creating template!","error")}})},getVariableList:function(i){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",s=[];return"general"===i||(TTD.objects.collections.templates.hasModel("archive",i)||s.push({key:"0",name:"All "+e}),TTD.CONST.archive_types[i].sub&&_.each(TTD.CONST.archive_types[i].sub,function(e,t){TTD.objects.collections.templates.hasModel("archive",i,t)||s.push({key:t,name:e})})),s},getSecondaryList:function(){var i=this,s=[];return _.each(TTD.CONST.archive_types,function(e,t){(i.getVariableList(t).length||"general"===t&&!TTD.objects.collections.templates.generalArchiveTemplateExists())&&s.push({key:t,name:e.name})}),s},enablePostFormats:function(){var s=[],n=!1;this.collection.each(function(e){"post"===e.secondary()&&s.push(e.format())}),this.$("#post-formats-select input").each(function(e,t){var i=t.nextElementSibling;-1===s.indexOf(t.value)?(t.disabled=!1,i.classList.remove("disabled"),n?t.checked=!1:(t.checked=!0,n=!0)):(t.disabled=!0,t.checked=!1,i.classList.add("disabled"))})},renderListSelect:function(){var i=this,e=[];TTD.objects.collections.templates.hasModel("blog")||e.push({key:"blog",name:"Blog"}),TTD.objects.collections.templates.hasModel("search")||e.push({key:"search",name:"Search"}),0<this.getSecondaryList().length&&e.push({key:"archive",name:"Archive"}),this.primarySelect&&this.primarySelect.undelegateEvents(),this.primarySelect=new n({el:this.$(".ttd-template-primary")[0],model:{list:e,label:"List Type:",default:e.length?e[0].key:""},on_select:function(e,t){"archive"===e?i.renderCustomArchiveSelect():i.clearCustomArchiveSelect()}}),1===e.length&&"archive"===e[0].key?this.renderCustomArchiveSelect():this.clearCustomArchiveSelect()},renderCustomArchiveSelect:function(){var i=this;this.variableSelect&&(this.variableSelect.set_value("0"),this.variableSelect.hide());var e=this.getSecondaryList();this.secondarySelect&&this.secondarySelect.undelegateEvents(),0!==e.length?(this.secondarySelect=new n({el:this.$(".ttd-template-secondary")[0],model:{list:e,label:"Archive Type:",default:e.length?e[0].key:""},on_select:function(e,t){i.variableSelectInit({key:e,name:t})}}),this.variableSelectInit(e[0])):this.$(".ttd-template-secondary").html("You've created templates for all the custom archives!")},clearCustomArchiveSelect:function(){this.$(".ttd-template-secondary").html(""),this.$(".ttd-template-variable").html(""),this.secondarySelect&&(this.secondarySelect.undelegateEvents(),this.secondarySelect=null),this.variableSelect&&(this.variableSelect.undelegateEvents(),this.variableSelect=null)},variableSelectInit:function(e){var t=this.getVariableList(e.key,e.name);this.variableSelect&&(this.variableSelect.$el.empty(),this.variableSelect.undelegateEvents()),0<t.length&&(this.variableSelect=new n({el:this.$(".ttd-template-variable").show()[0],model:{list:t,label:"Defined for:",default:t.length?t[0].key:""}}))}})},"reset.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/modals/templates/reset",model:null,after_open:function(e){this.model=e.model,this.$(".ttd-reset-template-name").html("<b>"+this.model.get("post_title")+"</b>")},reset:function(){var e=this;this.$content.addClass("ttd-loading small"),this.model.save({action:"reset_template"},{success:function(){e.$content.removeClass("ttd-loading small"),e.model.set("thumbnail",""),e.close(),TTD.utils.message("Template has been <b>reset</b> to default.")}})},on_enter:function(){this.reset()}})}},typography:{"delete.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/modals/typography/delete",model:null,after_open:function(e){this.model=e.model,this.$(".ttd-delete-template-name").html("<b>"+this.model.get("post_title")+"</b>")},delete:function(){var e=this;this.$content.addClass("ttd-loading small"),this.model.destroy({wait:!0,success:function(){e.$content.removeClass("ttd-loading small"),e.close(),TTD.utils.message("Template <b>deleted</b>.","success")}})},on_enter:function(){this.delete()}})},"export.js":function(e,t,i){var s,n;s=jQuery,n=i("./item-views/typography-item"),t.exports=i("../base").extend({template:"dashboard/modals/typography/export",model:null,export_ids:[],before_open:function(){this.model=new Backbone.Model,this.$("#export-archive-name").val(""),this.render_list()},render_list:function(){var i=this;this.$(".ttd-typography-items-list").empty(),_.each(TTD.objects.collections.typography.models,function(e,t){i.render_item(t,e)})},render_item:function(e,t){var i=new n({model:t,export_ids:this.export_ids});this.$(".ttd-typography-items-list").append(i.$el)},export:function(){var e=this;this.model.get("name")?this.export_ids.length?(TTD.Elements.$body.addClass("ttd-loading "),s.ajax({url:TTD.CONST.routes.typography+"/export",type:"POST",data:{typography:e.export_ids,name:e.model.get("name")},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){window.location.assign(e)}).error(function(){TTD.utils.message("Error exporting typography!","error",5e3)}).always(function(){e.close(),TTD.Elements.$body.removeClass("ttd-loading ")})):TTD.utils.message("No typography was selected!","error",3e3):TTD.utils.message("Please fill in a name for the archive!","error",3e3)},keyup:function(e){this.model.set("name",this.$("#export-archive-name").val())},on_enter:function(){this.export()}})},"import.js":function(e,t,i){var s,n;s=jQuery,n=i("./item-views/import_item"),t.exports=i("../base").extend({template:"dashboard/modals/typography/import",import_ids:[],extra_imports:{},before_open:function(){this.render_list()},render_list:function(){var i=this,s=this;this.$(".ttd-import-typography-list").empty(),_.each(this.response.items,function(e,t){s.render_typography(t,e,i.$(".ttd-import-typography-list"))})},render_typography:function(e,t,i){var s=new n({model:t});s.import_ids=this.import_ids,i.append(s.$el)},select_all:function(e){var i=this;this.$('.ttd-import-typography-list input[type="checkbox"]').each(function(e,t){t.checked=!0,-1===i.import_ids.indexOf(parseInt(t.value))&&i.import_ids.push(parseInt(t.value))})},select_none:function(e){var i=this;this.$('.ttd-import-typography-list input[type="checkbox"]').each(function(e,t){t.checked=!1,-1!==(e=i.import_ids.indexOf(parseInt(t.value)))&&i.import_ids.splice(e,1)})},import:function(){var e=this;this.import_ids.length?(TTD.Elements.$body.addClass("ttd-loading "),s.ajax({url:TTD.CONST.routes.typography+"/import",type:"POST",data:{extra_features:e.extra_imports,ids:e.import_ids,attachment_id:e.response.attachment_id},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){location.reload()}).error(function(){TTD.utils.message("Error importing typography!","error",5e3)}).always(function(){e.close(),TTD.Elements.$body.removeClass("ttd-loading ")})):TTD.utils.message("No typography was selected!","error",3e3)},on_enter:function(){this.import()}})},"item-views":{"import_item.js":function(e,t,i){jQuery,t.exports=i("../../../base").extend({tagName:"div",className:"ttd-import-item",template:"dashboard/modals/typography/item-views/import-item",select_import_typography:function(e){var t=this.import_ids.indexOf(this.model.ID);e.target.checked&&-1===t?this.import_ids.push(this.model.ID):e.target.checked||-1===t||this.import_ids.splice(t,1)}})},"import_preview.js":function(e,t,i){var s,n;s=jQuery,n=i("../import"),t.exports=i("../../../base").extend({template:"dashboard/modals/typography/import",initialize:function(){var t=this;TTD.objects.modals.typography_import_modal=new n({type:"small"}),this.import_typography_frame=wp.media.frames.file_frame=wp.media({title:"Import Theme Typography",button:{text:"Import"},multiple:!1,frame:"select",library:{type:"application/zip"}}),this.import_typography_frame.on("select",function(){TTD.Elements.$body.addClass("ttd-loading ");var e=t.import_typography_frame.state().get("selection").first().toJSON();if("application/zip"!==e.mime)return alert("Only .zip files are allowed"),TTD.Elements.$body.removeClass("ttd-loading "),void t.import_typography_frame.open();s.ajax({url:TTD.CONST.routes.typography+"/import_preview",type:"POST",data:{attachment_id:e.id},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(e){TTD.objects.modals.typography_import_modal.response=e,TTD.objects.modals.typography_import_modal.open()}).error(function(){TTD.utils.message("Error importing archive!","error",5e3)}).always(function(e){TTD.Elements.$body.removeClass("ttd-loading ")})})},open:function(){this.import_typography_frame.open()}})},"typography-item.js":function(e,t,i){jQuery,t.exports=i("../../../base").extend({tagName:"div",className:"ttd-typography-item",template:"dashboard/modals/typography/item-views/typography-item",initialize:function(e){this.export_ids=e.export_ids},select_template:function(e){var t=this.export_ids.indexOf(this.model.get("ID"));e.target.checked&&-1===t?this.export_ids.push(this.model.get("ID")):e.target.checked||-1===t||this.export_ids.splice(t,1)}})}},"reset.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/modals/typography/reset",model:null,after_open:function(e){this.model=e.model,this.$(".ttd-reset-typography-name").html("<b>"+this.model.get("post_title")+"</b>")},reset:function(){var e=this;this.$content.addClass("ttd-loading small"),this.model.meta("style",""),this.model.save({action:"reset"},{wait:!0,success:function(){e.$content.removeClass("ttd-loading small"),e.close(),TTD.utils.message("Typography set has been <b>reset</b> to default.")}})},on_enter:function(){this.reset()}})}},wizard:{"templates.js":function(e,t,i){var n;n=jQuery,t.exports=i("../base").extend({className:"ttd-wizard-templates-modal",template:"dashboard/modals/wizard/templates",item:TTD.utils.tpl("dashboard/modals/wizard/template"),itemClass:".ttd-wizard-template",hasPreview:!1,after_initialize:function(e){this.$el.addClass(this.className),this.$templatesList=this.$("#structure-templates-list")},after_open:function(){var t=this,i=this.$(".modal-content").addClass("ttd-loading loader-absolute");this.toggleClass("w-narrow",!!this.model.getStepKey("narrowTemplate")),this.model.loadStepTemplates().then(function(e){t.templateData=_.sortBy(e,function(e){return e.order}),t.hasPreview||(t.createLazyLoader(),t.buildPreview()),t.markSelectedTemplate(t.model.getPreviewTemplateId()),i.removeClass("ttd-loading loader-absolute")})},createLazyLoader:function(){this.lazyLoader=new window.LazyLoad({container:this.$el[0],elements_selector:".tve-lazy-img",threshold:0,load_delay:0,callback_loaded:function(e){n(e).parent().removeClass("lazy-loading")}})},updateLazyLoader:function(){this.lazyLoader.update()},buildPreview:function(){var t=this,i="";_.each(this.templateData,function(e){i+=t.item({model:t.model,item:e,itemClass:t.itemClass.replace(".","")})}),this.$templatesList.html(i);var s=parseInt(this.$templatesList.find(this.itemClass).width());this.$templatesList.find("img").each(function(){var e=this.dataset.ratio;e&&n(this).parent().css("height",s*parseFloat(e))}),this.$templatesList.hasClass("masonry")&&this.$templatesList.masonry("destroy"),this.$templatesList.masonry({gutter:30,columnWidth:this.itemClass,isAnimated:!0}),this.hasPreview=!0,setTimeout(function(){TTD.utils.init_scrollbar(t.$(".modal-content"),{onInit:function(e){e.removeClass("ttd-loading modal-content")}})},100),this.updateLazyLoader(),TTD.utils.do_action("theme.wizard.build_preview",this)},markSelectedTemplate:function(e){this.$(this.itemClass).removeClass("active").filter('[data-id="'.concat(e,'"]')).addClass("active")},clickSelect:function(e,n){var a=this;return("cloud"===n.dataset.source?new Promise(function(i,t){var s=a.model.get("active");a.$(".modal-inner").addClass("ttd-loading"),TTD.objects.templatesStore.fetchInstance(s,n.dataset.id).done(function(e){var t=e.data||e;TTD.objects.templatesStore.updateTemplateId(s,n.dataset.id,t.id),n.setAttribute("data-id",t.id),n.setAttribute("data-source","local"),a.$(".modal-inner").removeClass("ttd-loading"),i(t)}).error(function(e){return t(e)})}):new Promise(function(e){e({id:n.dataset.id})})).then(function(e){a.markSelectedTemplate(e.id),TTD.objects.wizardView.previewTemplate(e.id),setTimeout(function(){a.close()}),TTD.utils.do_action("theme.wizard.select_template",a)}),!1}})}}},"no-skin.js":function(e,t,i){var s;s=i("./base").extend({template:"dashboard/no-skin",openModal:function(){TTD.objects.modals.new_skin.open({collection:TTD.objects.collections.skins})}}),t.exports=new s({preventRender:!0})},preview:{"info.js":function(e,t,i){var s;jQuery,s=i("../base"),t.exports=s.extend({template:"dashboard/preview/info",set_skin_preview_name:function(e){this.$(".ttd-skin-preview-name").html(e)}})},"item.js":function(e,t,i){var s;jQuery,s=i("../base"),t.exports=s.extend({className:"ttd-skin-item-container",template:"dashboard/preview/item",after_render:function(){this.listenTo(this.model,"change:preview_open",this.render)},change_skin_preview:function(){var e=this.get_new_src(TTD.Views.Preview.$iframe.attr("src"));TTD.Views.Preview.set_preview_model(this.model.set("preview_open",1)),TTD.Views.Preview.render({url:e})},get_new_src:function(e){var t=new RegExp("thrive_skin_preview=\\d+"),i=e.match(t);return e.replace(i[0],"thrive_skin_preview="+this.model.get("term_id"))}})},"list.js":function(e,t,i){var s,n;jQuery,s=i("../base"),n=i("./item"),t.exports=s.extend({template:"dashboard/preview/list",after_render:function(){this.render_list(),TTD.utils.init_scrollbar(this.$(".ttd-skin-scroll"))},toggle_list_dropdown:function(e){e.currentTarget.classList.toggle("ttd-rotate"),this.$(".ttd-skins-list").toggle()},render_list:function(){var e=TTD.objects.collections.skins,i=this.$(".ttd-skins-list").empty();e.each(function(e){if(!e.is_active()){var t=new n({model:e});i.append(t.$el)}})}})},"preview.js":function(e,t,i){var s,n,a,o,r;s=jQuery,n=i("../base"),a=i("./info"),o=i("./item"),r=i("./list"),t.exports=n.extend({template:"dashboard/preview/preview",after_render:function(e){var t=this;this.$iframe=this.$("iframe.ttd-site-preview"),this.load_iframe(e.url),this.render_preview_info(),this.render_active_skin(),this.$skin_view=new r({el:this.$(".ttd-preview-skins-list-content")[0]}),TTD.utils.add_action("theme.document.keyup",function(e){27===e.keyCode&&t.$el.find(".ttd-preview-skins-drop-sidebar").hasClass("ttd-anim-down")&&s(".ttd-theme-info").click()})},load_iframe:function(e){var t=this;this.$iframe.parent().addClass("ttd-loading"),this.$iframe.one("load",function(){t.$iframe[0].contentDocument.addEventListener("click",function(){return t.hide_skin_list()}),TTD.Elements.$body.removeClass("ttd-loading "),t.$iframe.parent().removeClass("ttd-loading"),t.show()}),this.$iframe.attr("src",e)},close:function(){TTD.Elements.$body.removeClass("ttd-in-preview"),this.hide()},toggle_toolbar:function(){var e=this.$(".ttd-site-preview-container");e.hasClass("ttd-fullheight")?setTimeout(function(){e.removeClass("ttd-fullheight")},500):e.addClass("ttd-fullheight"),this.$(".preview-bar").slideToggle(),this.$(".ttd-buttons-fixed").slideToggle(),this.$(".ttd-preview-skins-drop-sidebar").removeClass("ttd-anim-down ttd-anim-up")},toggle_skin_view:function(){this.is_visible()?this.hide_skin_list():this.show_skin_list()},hide_skin_list:function(){this.$(".ttd-theme-info").removeClass("ttd-change-bg").parent().next().removeClass("ttd-anim-down").addClass("ttd-anim-up"),this.$(".ttd-icon-blue").removeClass("ttd-change-bg").addClass("ttd-change-bg-reverse")},show_skin_list:function(){this.$(".ttd-theme-info").addClass("ttd-change-bg").parent().next().show().addClass("ttd-anim-down").removeClass("ttd-anim-up"),this.$(".ttd-icon-blue").addClass("ttd-change-bg").removeClass("ttd-change-bg-reverse")},is_visible:function(){return this.$(".ttd-theme-info").hasClass("ttd-change-bg")},render_preview_info:function(){this.$preview_info=new a({el:this.$(".ttd-preview-info-container")[0],model:this.model})},render_active_skin:function(){this.$active_skin_view=new o({model:TTD.objects.collections.skins.get_active_skin()}),this.$(".ttd-preview-active-skin-container").append(this.$active_skin_view.$el)},set_preview_model:function(e){this.model.set("preview_open",0),this.model=e},activate_skin:function(){this.model.make_active()}})}},"select.js":function(e,t,i){var s;s=jQuery,t.exports=i("./base").extend({template:"dashboard/utils/select",before_initialize:function(e){var t=this;"function"==typeof e.on_select&&(this.on_select=e.on_select.bind(this)),TTD.utils.add_action("theme.document.click",function(e){0===t.$el.find(e.target).length&&t.close()}),this.model instanceof Backbone.Model||(this.model=new Backbone.Model(this.model)),this.listenTo(this.model,"change:list",this.render)},after_render:function(){var t=this.$("ul");_.each(this.model.get("list"),function(e){t.append('<li class="click" data-fn="set_value" data-key="'+e.key+'">'+e.name+"</li>")}),void 0!==this.model.get("default")&&this.set_value(this.model.get("default"))},select_toggle:function(){this.is_open()||s(".ttd-drop-down").removeClass("active"),this.$el.toggleClass("active")},set_value:function(e){var t="";t="string"==typeof e||"number"==typeof e?e:e.currentTarget.dataset.key;var i=this.$("ul li").removeClass("active").filter('[data-key="'+t+'"]').addClass("active").text();this.$el.removeClass("active").find(".default-value").attr("data-key",t).html(i),"object"===_typeof(e)&&this.on_select(t,i,e)},get_value:function(){var e=this.$(".default-value").attr("data-key");return"0"!==e&&"general"!==e||(e=""),e},open:function(){this.$el.addClass("active")},close:function(){this.$el.removeClass("active")},is_open:function(){return this.$el.hasClass("active")},on_select:function(){}})},sidebar:{branding:{favicon:{"main.js":function(e,t,i){var s=i("../../../../models/media-library");t.exports=i("../../../base").extend({template:"dashboard/sidebar/branding/favicon/main",after_initialize:function(){this.mediaLibrary=this.initMediaLibrary()},after_render:function(){var e=TTD.CONST.branding.favicon.id,i=this.$(".favicon-preview-button");i.addClass("ttd-loading tiny"),jQuery.ajax({url:TTD.CONST.routes.images+"/"+e,type:"get",headers:{"X-WP-Nonce":TTD.CONST.nonce},data:{is_favicon:!0}}).success(function(e){var t=e||TTD.CONST.branding.favicon.placeholder;i.removeClass("ttd-loading tiny").css("background-image","url("+t+")")}).error(function(){TTD.utils.message("Error retrieving the favicon.","error")})},resetFavicon:function(){var e=TTD.CONST.branding.favicon.placeholder;this.saveFavicon(0,e)},saveFavicon:function(e,t){var i=this;TTD.utils.save_options(TTD.CONST.branding.favicon.db_option,e,function(){i.$(".favicon-preview-button").css("background-image","url("+t+")"),jQuery('link[rel*="icon"]').prop("href",t),i.$(".ttd-favicon-reset").toggle(!!e),TTD.utils.message("Favicon saved successfully!","success")})},shouldHideReset:function(){return 0===parseInt(TTD.CONST.branding.favicon.id)},openMedia:function(){this.mediaLibrary.open()},initMediaLibrary:function(){var t=this;return new s({gallery_args:{title:"Add a Favicon"},callbacks:{on_select:function(e){["image/png","image/jpeg","image/gif","image/x-icon"].includes(e.mime)?t.saveFavicon(e.id,e.url):(TTD.utils.message("Accepted formats: png, jpg, gif, ico.","error"),t.instance.open())},on_open:function(){void 0===t.mediaLibrary.get_instance()&&TTD.utils.message("Error while opening the media gallery!","error")}}})}})}},"global-colors":{"color-picker.js":function(e,t,i){var n,a,o,r,l;n=jQuery,o=!(a={}),l=r="",t.exports={get_spectrum_instance:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i={preferredFormat:"hex",showInput:!0,alpha_input:!0,showAlpha:!0,allowAlpha:!0,cancelText:"CANCEL",chooseText:"APPLY",move:this.move,change:this.change,hide:this.hide},s=n("iframe");return r=e.overlay,s.length&&s.on("load",function(){l=s[0].contentDocument.children[0]}),t=Object.assign(t,i),a=e.input.spectrum(t)},move:function(e){var t=a.spectrum("option","model");t.set("color",e),l&&l.setAttribute("style","--tcb-color-"+t.get("id")+":"+e),n(".sp-color-preview").css("background-color",e)},change:function(e,t){if(t&&t.from_input)return a.spectrum("option","move")(e);r.hide(),o=!0;var i=a.spectrum("option","model"),s=_.findIndex(TTD.CONST.branding.global_colors,function(e){return e.id===i.get("id")});TTD.CONST.branding.global_colors[s].color=e.toRgbString();var n=Object.assign({},TTD.CONST.branding.global_colors[s]);delete n.active,TTD.utils.tcb_editor_ajax_request("global_colors",n,function(){TTD.utils.message("Color saved successfully!","success"),o=!1})},hide:function(e){r.hide(),o||(a.spectrum("option","model").set("color",e),l&&l.setAttribute("style",""))}}},"item.js":function(e,t,i){var s,n,a;s=jQuery,n=i("../../../base"),a=!1,t.exports=n.extend({tagName:"div",className:"ttd-global-color-row",template:"dashboard/sidebar/branding/global-colors/item",before_initialize:function(e){this.colorPicker=e.colorPicker,this.optionsTooltip=e.optionsTooltip,this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"change:index",this.reposition)},reposition:function(e){var t=this.el.style.top?parseInt(this.el.style.top,10):0,i=e.get("index")-e._previousAttributes.index;this.el.style.top=t+i*this.$el.outerHeight(!0)+"px"},show_tooltip:function(e){this.$el.append(this.optionsTooltip.$el.css({top:25})),this.$el.toggleClass("tooltip-open")},open_color_picker:function(e){this.colorPicker.spectrum("option","model",this.model),this.colorPicker.spectrum("set",this.model.get("color")),s(".sp-color-preview").css("background-color",this.model.get("color")),this.colorPicker.spectrum("show");var t=s(e.target).closest(".ttd-global-color-row").offset();return this.colorPicker.spectrum("container").css({top:t.top-60}),!1},name_edit:function(){0===this.$el.find("input").length&&(this.$el.find(".ttd-global-color-text").html('<input class="keydown blur" type="text" data-fn="save_name" value="'+this.model.get("name")+'">').find("input").focus(),this.$el.addClass("name-edit-mode"))},save_name:function(e){var t=this;if("keydown"!==e.type||(a=27===e.keyCode,13===e.keyCode))if(this.$el.removeClass("name-edit-mode"),a)a=!1;else{var i=this.$el.find("input").val().trim();if(i!==this.model.get("name")){if(i&&0!==i.length){this.model.set({custom_name:1,name:i});var s=_.findIndex(TTD.CONST.branding.global_colors,function(e){return e.id===t.model.get("id")});TTD.CONST.branding.global_colors[s]=Object.assign(TTD.CONST.branding.global_colors[s],{name:i,custom_name:1});var n=Object.assign({},TTD.CONST.branding.global_colors[s]);delete n.active,TTD.utils.tcb_editor_ajax_request("global_colors",n,function(){TTD.utils.message("Name saved successfully.")})}}else this.render()}else 27===e.keyCode&&this.render()}})},"list.js":function(e,t,s){var n,i,a,o,r,l;n=jQuery,i=s("../../../../collections/base").extend({comparator:function(e,t){return e.get("name").toLowerCase().localeCompare(t.get("name").toLowerCase())}}),a=s("../../../base"),o=s("./item"),r=a.extend({tagName:"div",className:"ttd-global-color-tooltip click",template:"dashboard/sidebar/branding/global-colors/tooltip",after_initialize:function(){this.$el.attr("data-fn","name_edit")}}),l=new i,t.exports=a.extend({template:"dashboard/sidebar/branding/global-colors/list",hide_tooltip:function(){this.$(".tooltip-open").removeClass("tooltip-open")},after_initialize:function(){var t=this,e=n("iframe");e.on("load",function(){e[0].contentDocument.addEventListener("click",function(){return t.hide_tooltip()})}),this.optionsTooltip=new r,TTD.utils.add_action("theme.document.click",function(e){n(e.target).closest(".dots").length||t.hide_tooltip()});var i={input:this.$("#ttd-color-picker"),overlay:this.$("#ttd-color-picker-overlay")};this.color_picker=s("./color-picker").get_spectrum_instance(i,{appendTo:"#ttd-global-vars-container"}),this.$list=this.$("#ttd-global-colors-container"),this.listenTo(l,"reset",this.render_items),this.listenTo(l,"change:name",this.sort_and_index),TTD.utils.get_options("thrv_global_colours",function(e){l.reset(e),TTD.CONST.branding.global_colors=e,t.$el.removeClass("ttd-loading small")},"global_colors")},sort_and_index:function(){l.sort().each(function(e){e.set("index",l.indexOf(e))})},render_items:function(){var t=this;this.$list.empty(),this.sort_and_index(),l.each(function(e){t.$list.append(new o({model:e,colorPicker:t.color_picker,optionsTooltip:t.optionsTooltip}).$el)}),l.length||this.$list.text("You have no global colors on your templates.")},stop_click:function(e){e.stopPropagation()}})}},logo:{"item.js":function(e,t,i){var s,n;s=jQuery,n=i("../../../../models/media-library"),t.exports=i("../../../base").extend({template:"dashboard/sidebar/branding/logo/item",className:"logo-container",after_initialize:function(){var i=this;this.mediaLibrary=this.initMediaLibrary(),this.listenTo(this.model,"change:attachment_id",function(e,t){t&&0!==parseInt(t)&&i.loaderTarget().addClass("ttd-loading small"),i.model.fetchSourceForAttachmentId()}),this.listenTo(this.model,"change:src",this.render)},loaderTarget:function(){return this.$el},after_render:function(){var i=this;this.loaderTarget().addClass("ttd-loading small"),requestAnimationFrame(function(){var e=i.model.get("src");e&&0!==e.length||(e=i.model.getPlaceholder());var t=new Image;t.src=e,t.onload=function(){i.loaderTarget().removeClass("ttd-loading small"),i.$(".logo-button").css("background-image","url("+e+")")}})},openMedia:function(){this.mediaLibrary.open()},initMediaLibrary:function(){var t=this;return new n({gallery_args:{title:"Upload Images"},callbacks:{on_select:function(e){if(-1===["image/png","image/jpeg","image/gif"].indexOf(e.mime))return TTD.utils.message("Accepted formats: png, jpg, gif.","error"),void t.instance.open();t.saveLogo(e.id,e.url)},on_open:function(){void 0===t.mediaLibrary.get_instance()&&TTD.utils.message("Error while opening the media gallery!","error")}}})},resetLogo:function(){this.saveLogo(0,this.model.getPlaceholder())},saveLogo:function(e,t){var i=this;this.model.saveLogoAttachmentId(e,t,function(){i.$(".logo-button").css("background-image","url("+t+")"),i.$(".ttd-logo-reset").toggle(!!e),TTD.utils.reload_iframe(s("iframe")),TTD.utils.message("Logo saved successfully!","success")})}})},"main.js":function(e,t,i){var s=i("../../../../models/logo"),n=i("./item");t.exports=i("../../../base").extend({template:"dashboard/sidebar/branding/logo/main",after_initialize:function(){this.$("#ttd-logo-preview-wrapper").append(new n({model:new s({type:"dark"})}).$el).append(new n({model:new s({type:"light"})}).$el)},saveLogoUrl:function(){var e=this.$("#logo-redirect-url").val();!e||TTD.utils.validate_url(e)?(TTD.CONST.branding.logo_data.redirect_url=e,TTD.utils.save_options(TTD.CONST.branding.logo_data.url_db_option,e,function(){return TTD.utils.message("Logo URL saved successfully!","success")})):TTD.utils.message("Please insert a valid URL.","error")}})}},"main.js":function(e,t,i){var s,n,a;s=jQuery,n=i("./logo/main"),a=i("./favicon/main"),t.exports=i("../../base").extend({template:"dashboard/sidebar/branding/main",after_initialize:function(){var e=i("./skin-palettes/list");this.skin_palettes=new e({el:this.$("#ttd-skin-palettes-wrapper")}),this.logo_settings=new n({el:this.$("#ttd-logo-wrapper")}),this.favicon_settings=new a({el:this.$("#ttd-favicon-wrapper")}),this.$(".ttd-sidebar-branding-block").hide()},toggle_dropdown:function(e){var t=s(e.target).closest(".ttd-sidebar-branding-header "),i=t.find(".dropdown-arrow");i.hasClass("ttd-flip")||(this.$(".ttd-sidebar-branding-block").hide(),this.$(".ttd-flip").removeClass("ttd-flip")),i.toggleClass("ttd-flip"),t.next().toggle()}})},"skin-palettes":{"color-picker.js":function(e,t,i){!function(r){var l={},o="",c={},d="",h={},p={},u="",m=!1,f=!1;function g(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=TTD.CONST.skin_variables.colors.findIndex(function(e){return parseInt(e.id)===parseInt(t)});_.each(e,function(e,t){TTD.CONST.skin_variables.colors[i][t]=e})}function T(){c={},h={},u=o=d="",f=m=!(p={})}t.exports={getSpectrumInstance:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i={preferredFormat:"hex",showInput:!0,alpha_input:!0,showAlpha:!0,allowAlpha:!0,cancelText:"CANCEL",chooseText:"APPLY",saveOnApply:!0,move:this.move,change:this.change,hide:this.hide,beforeShow:this.beforeShow};return e.overlay,l=e.input.spectrum(_objectSpread({},i,{},t)),r(l[0]).on("hue.changed.spectrum",function(e,t){t<=1&&(t*=360),m=!0,d=parseInt(t)}),r(l[0]).on("color.ration.spectrum",function(e,t){u=t}),l},hide:function(){if(f){var e=l.spectrum("option","model");TTD.utils.changeCssVariableValue(e.get("css_variable"),e.get("variable").color),_.each(h,function(e){TTD.utils.changeCssVariableValue(e.css_variable,e.color)}),T()}},beforeShow:function(){T();var e=l.spectrum("option","model"),t=e.get("variable"),i=tinycolor(TTD.utils.getCssVariableValue(e.get("css_variable")));c=i.toHsl(),d=c.h,o=e.get("css_variable"),t.hsl&&[c.h,c.s,c.l].includes(0)&&(d=parseInt(t.hsl.h),l.spectrum("set",tinycolor({h:t.hsl.h,l:t.hsl.l,s:t.hsl.s,a:c.a}))),_.each(e.get("linked_variables"),function(e,t){p[e]=TTD.utils.getCssVariableValue(e);var i=_.find(TTD.CONST.skin_variables.colors,function(e){return parseInt(e.id)===parseInt(t)});i&&(h[e]=i,h[e].tmp_hsl_parent_dependency={h:parseInt(i.hsl_parent_dependency.h),l:parseFloat(i.hsl_parent_dependency.l),s:parseFloat(i.hsl_parent_dependency.s)})})},move:_.debounce(function(e){TTD.utils.changeCssVariableValue(o,e.toRgbString());var t,i,s,n,a=e.toHsl();0===a.h&&1===a.l&&0===a.s&&m&&l.spectrum("set",tinycolor({h:d,l:Math.min(.99,Math.max(.01,a.l)),s:Math.min(.99,Math.max(.01,a.s)),a:a.a})),0!==a.s&&0!==a.l||!m||(a.h=d),0===a.s&&0===a.l&&(a.s=(t=parseInt(d),i=u.s,s=u.v,n=(2-i)*s/2,0!==n&&(i=1===n?0:n<.5?i*s/(2*n):i*s/(2-2*n)),{h:t,s:i,l:n}).s),_.each(a,function(e,t){a[t]=TTD.utils.toFixed(e,2)}),_.each(p,function(e,t){TTD.utils.changeCssVariableValue(t,function(e,t,i,s,n){var a=tinycolor(e);i&&(a=tinycolor({h:i.hsl_parent_dependency.h,l:Math.min(.99,Math.max(.01,i.hsl_parent_dependency.l)),s:Math.min(.99,Math.max(.01,i.hsl_parent_dependency.s)),a:tinycolor(e).toHsl().a})),s&&a.spin(parseInt(t.h)-parseInt(n.h));var o=a.toHsl();if(i){0===o.h&&(o.h=i.hsl_parent_dependency.h),s&&(i.tmp_hsl_parent_dependency.h=parseInt(o.h));var r=i.lock;if(_.isEmpty(r)||void 0===r.saturation||0===parseInt(r.saturation)){var l=TTD.utils.toFixed(t.s-n.s,2);i.tmp_hsl_parent_dependency.s=TTD.utils.toFixed(parseFloat(i.hsl_parent_dependency.s)+l,2)}if(_.isEmpty(r)||void 0===r.lightness||0===parseInt(r.lightness)){var c=TTD.utils.toFixed(t.l-n.l,2);i.tmp_hsl_parent_dependency.l=TTD.utils.toFixed(parseFloat(i.hsl_parent_dependency.l)+c,2)}o.h=i.tmp_hsl_parent_dependency.h,o.s=Math.min(1,Math.max(0,i.tmp_hsl_parent_dependency.s)),o.l=Math.min(1,Math.max(0,i.tmp_hsl_parent_dependency.l)),0===o.l&&(o.l=.01),0===o.s&&(o.s=.01)}return tinycolor(o).toRgbString()}(e,a,h[t],m,c))}),m=!(f=!0)},0),change:function(e,t){if(t&&t.from_input)l.spectrum("move");else if(f){var i=l.spectrum("option","model"),s=i.get("variable"),n={value:e.toRgbString(),id:s.id,type:s.type,key:"color",name:i.get("name")},a={color:e.toRgbString()};if(s.hsl){var o=e.toHsl();s.hsl={h:parseInt(d),s:TTD.utils.toFixed(Math.min(.99,Math.max(.01,o.s)),2),l:TTD.utils.toFixed(Math.min(.99,Math.max(.01,o.l)),2)},n.hsl=s.hsl,a.hsl=s.hsl}g(s.id,a),_.isEmpty(h)||(n.linked_variables={},_.each(h,function(e){var t=TTD.utils.getCssVariableValue(e.css_variable);n.linked_variables[e.id]={value:t,hsl_parent_dependency:e.tmp_hsl_parent_dependency},g(e.id,{color:t,hsl_parent_dependency:e.tmp_hsl_parent_dependency})})),l.spectrum("option","saveOnApply")&&r.ajax({url:"".concat(TTD.CONST.routes.skins,"/").concat(TTD.CONST.skin_id,"/skin_variables"),type:"POST",data:n,headers:{"X-WP-Nonce":TTD.CONST.nonce}}).success(function(){TTD.utils.message("Color saved successfully!","success")}).error(function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}),TTD.utils.do_action("skin_color_updated",n),T()}}}}(jQuery)},"item.js":function(e,t,i){t.exports=i("../../../base").extend({template:"dashboard/sidebar/branding/skin-palettes/variable-item",before_initialize:function(e){this.colorPicker=e.colorPicker,this.extra_class=e.extra_class},render:function(){this.$el.html(TTD.utils.tpl(this.template)({model:this.model,extra_class:this.extra_class}))},editSkinVariable:function(e){var t=TTD.utils.getCssVariableValue(this.model.get("css_variable"));return this.colorPicker.spectrum("option","model",this.model),this.colorPicker.spectrum("set",t),this.colorPicker.spectrum("show"),this.colorPicker.spectrum("container").css({top:e.target.closest(".ttd-skin-color-row").offsetTop+50,left:e.target.closest(".ttd-skin-color-row").offsetLeft+35}),!1}})},"list.js":function(e,t,s){var l,i,n,a;l=jQuery,i=s("./select"),n=s("./item"),a=s("../global-colors/list"),t.exports=s("../../../base").extend({template:"dashboard/sidebar/branding/skin-palettes/list",variableItem:TTD.utils.tpl("dashboard/sidebar/branding/skin-palettes/variable-item"),palettesSelect:null,colorPicker:null,after_initialize:function(e){var t=this;TTD.utils.add_action("message:ttb.skin_variables_changed",function(e){var i=e.color_data,s=[];s.push({id:i.id,hsl:i.hsl,color:i.value}),_.each(i.linked_variables,function(e,t){s.push({id:t,hsl_parent_dependency:t.hsl_parent_dependency,color:i.value})}),t.updateSkinColors(s)}),TTD.utils.add_action("message:ttb.skin_palette_reset",function(e){t.updateSkinColors(e.palette.colors),t.updateSkinGradients(e.palette.gradients)}),TTD.utils.add_action("message:ttb.skin_palette_changed",function(e){t.afterPaletteChanged(e.data.active_id,!1)});var i=_objectSpread({appendTo:"#ttd-skin-palettes-wrapper"},e.spectrumOptions);this.skinVariables=this.getSkinVariables(TTD.CONST.skin_variables),this.skinPalettes=TTD.CONST.skin_palettes,this.$paletteContainer=this.$("#ttd-skin-palette-container"),this.$masterVarsContainer=this.$("#ttd-skin-master-vars-container"),this.$otherVarsContainer=this.$("#ttd-skin-other-vars-container"),this.$globalVarsContainer=this.$("#ttd-global-vars-container"),this.colorPicker=s("./color-picker").getSpectrumInstance({input:this.$("#ttd-skin-color-picker"),overlay:this.$("#ttd-skin-color-picker-overlay")},i),this.skinPalettes&&0<this.skinPalettes.modified.length&&(this.activePaletteID=this.skinPalettes.active_id,this.$paletteContainer.append(TTD.utils.tpl("dashboard/sidebar/branding/skin-palettes/palettes")()),this.buildPalettesSelect()),this.skinVariables.master_variables.length&&_.each(this.skinVariables.master_variables,function(e){t.outputVariables(t.$masterVarsContainer,e,!0)}),this.skinVariables.other_variables.length&&(this.$otherVarsContainer.append(TTD.utils.tpl("dashboard/sidebar/branding/skin-palettes/other-vars-header")()),_.each(this.skinVariables.other_variables,function(e){t.outputVariables(t.$otherVarsContainer,e,!1)})),this.globalColors=new a({el:this.$globalVarsContainer})},outputVariables:function(e,t,i){var s=new Backbone.Model({name:t.name,css_variable:t.css_variable,linked_variables:i?this.getLinkedVars(t.type,t.id):{},variable:t,bg:t.css});e.append(new n({model:s,extra_class:i?"":"other_var",colorPicker:this.colorPicker}).$el)},buildPalettesSelect:function(){this.palettesSelect=new i({el:this.$("#ttd-skin-palettes-select")[0],list:this,on_select:_.bind(this.afterPaletteChanged,this),model:new Backbone.Model({list:this.getSelectList(),default:this.activePaletteID})})},afterPaletteChanged:function(e){var i=this,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],s=this.activePaletteID,n=["id","color","gradient","hsl","hsl_parent_dependency"],a=JSON.stringify({colors:TTD.utils.filterDataByAllowedArr(TTD.CONST.skin_variables.colors,n),gradients:TTD.utils.filterDataByAllowedArr(TTD.CONST.skin_variables.colors,n)}),o=["id","color","gradient","name","custom_name","parent","hsl","hsl_parent_dependency"],r=JSON.parse(a);return _.each(r,function(e,t){i.skinPalettes.modified[s][t]=e}),this.updateSkinColors(this.skinPalettes.modified[e].colors),this.updateSkinGradients(this.skinPalettes.modified[e].gradients),this.activePaletteID=parseInt(e),this.palettesSelect.model.set("list",this.getSelectList()),this.palettesSelect.reflowList(),t&&l.ajax({url:"".concat(TTD.CONST.routes.skins,"/").concat(TTD.CONST.skin_id,"/change_palette"),type:"POST",data:{previous_skin_data:a,active_skin_data:JSON.stringify({colors:TTD.utils.filterDataByAllowedArr(TTD.CONST.skin_variables.colors,o),gradients:TTD.utils.filterDataByAllowedArr(TTD.CONST.skin_variables.gradients,o)}),previous_id:s,active_id:this.activePaletteID},headers:{"X-WP-Nonce":TTD.CONST.nonce}}).success(function(){TTD.CONST.skin_palettes.active_id=i.activePaletteID}).error(function(e){e.responseJSON&&TTD.utils.message(e.responseJSON.message,"error")}),!1},getSelectList:function(){var s=this,n=[];return _.each(this.skinPalettes.modified,function(e,t){var i=t===s.activePaletteID;n.push({key:t,name:s.getPalettePreview(e,i)})}),n},getPalettePreview:function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n='<div class="skin-palette">';return _.each(this.skinVariables.master_variables,function(t){var e=i.colors.find(function(e){return parseInt(e.id)===parseInt(t.id)}).color;s&&(e="var(".concat(TTD.CONST.skin_variables.colors_prefix).concat(t.id,")")),n+='<div class="skin-palette-item" style="background-color: '.concat(e,'"></div>')}),n+="</div>"},updateSkinColors:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];_.each(e,function(t){TTD.utils.changeCssVariableValue(TTD.CONST.skin_variables.colors_prefix+t.id,t.color);var e=TTD.CONST.skin_variables.colors.findIndex(function(e){return parseInt(e.id)===parseInt(t.id)});-1<e&&(TTD.CONST.skin_variables.colors[e].color=t.color,TTD.CONST.skin_variables.colors[e].hsl_parent_dependency?TTD.CONST.skin_variables.colors[e].hsl_parent_dependency=_.extend({},t.hsl_parent_dependency):TTD.CONST.skin_variables.colors[e].hsl&&(TTD.CONST.skin_variables.colors[e].hsl=_.extend({},t.hsl)))})},updateSkinGradients:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];_.each(e,function(t){TTD.utils.changeCssVariableValue(TTD.CONST.skin_variables.gradients_prefix+t.id,t.gradient);var e=TTD.CONST.skin_variables.gradients.findIndex(function(e){return parseInt(e.id)===parseInt(t.id)});-1<e&&(TTD.CONST.skin_variables.gradients[e].gradient=t.gradient)})},resetPalette:function(){if(!confirm("Are you sure you want to reset this palette?"))return!1;var e=this.skinPalettes.original[this.activePaletteID];return this.updateSkinColors(e.colors),this.updateSkinGradients(e.gradients),l.ajax({url:"".concat(TTD.CONST.routes.skins,"/").concat(TTD.CONST.skin_id,"/reset_palette"),type:"POST",data:{active_id:this.activePaletteID},headers:{"X-WP-Nonce":TTD.CONST.nonce}}),!1},getLinkedVars:function(e,t){var i=TTD.CONST.skin_variables["".concat(e,"_prefix")],s={};return _.each(TTD.CONST.skin_variables[e],function(e){_.isNumber(e.parent)&&e.parent===t&&(s[e.id]=i+e.id)}),s},getSkinVariables:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o={master_variables:[],other_variables:[]};return _.isEmpty(e)||_.each(["colors","gradients"],function(n){var a=e["".concat(n,"_prefix")];_.each(e[n],function(e){var t=parseInt(e.parent),i="var(".concat(a).concat(e.id,")"),s="colors"===n?"linear-gradient(".concat(i,", ").concat(i,")"):i;Object.assign(e,{type:n,css_variable:a+e.id,prefix:a,css:s}),-1===t?o.master_variables.push(e):_.isNaN(t)&&o.other_variables.push(e)})}),o}})},"select.js":function(e,t,i){var s=i("../../../../views/select");t.exports=s.extend({before_initialize:function(e){s.prototype.before_initialize.apply(this,arguments),this.list=e.list},reflowList:function(){var t=this.$("ul");t.empty(),this.model.get("list").forEach(function(e){t.append('<li class="click" data-fn="set_value" data-key="'.concat(e.key,'">').concat(e.name,"</li>"))})},set_value:function(e){var t="";t="string"==typeof e||"number"==typeof e?e:e.currentTarget.dataset.key;var i=this.list.getPalettePreview(this.list.skinPalettes.modified[this.list.activePaletteID],!0),s=this.list.skinPalettes.modified[this.list.activePaletteID].name;this.$el.removeClass("active").find(".default-value").attr("data-key",t).html(i+s),"object"===_typeof(e)&&this.on_select(t,i,e)}})}}},"performance.js":function(e,t,i){var s;jQuery,s=[{key:"cache",label:"Minification and Caching"},{key:"image",label:"Image Optimization"},{key:"amp",label:"Accelerated Mobile Pages"}],t.exports=i("../base").extend({template:"dashboard/sidebar/performance/main",navItemTemplate:"dashboard/sidebar/performance/nav-item",before_initialize:function(e){this.tab=e.tab?e.tab:""},after_render:function(){var t=this;this.$navItems=this.$(".ttd-performance-nav"),s.forEach(function(e){t.$navItems.append(TTD.utils.tpl(t.navItemTemplate)({item:e,active:t.tab}))})},goTo:function(e,t){TTD.Router.navigate("#performance/".concat(t.dataset.tab),{trigger:!0})}})},"settings.js":function(e,t,i){jQuery,t.exports=i("../base").extend({template:"dashboard/sidebar/settings"})},"templates.js":function(e,t,i){var s,n,a;jQuery,s=i("../modals/templates/full-reset"),n=i("../modals/templates/item-views/import_preview"),a=i("../modals/templates/export"),t.exports=i("../base").extend({template:"dashboard/sidebar/templates",after_initialize:function(){TTD.objects.modals.reset_modal=new s({type:"small"}),TTD.objects.modals.import_view=new n,TTD.objects.modals.export_modal=new a({type:"small"}),this.listenTo(TTD.objects.models.filter,"theme_dash:filter",this.updateCounters)},after_render:function(){this.updateCounters()},factory_reset:function(){return TTD.objects.modals.reset_modal.open()},import:function(){TTD.objects.modals.import_view.open()},export:function(){TTD.objects.modals.export_modal.open()},filterByName:function(e){TTD.objects.models.filter.setOptions({name:e.currentTarget.value})},showByType:function(e){var t=e.currentTarget.getAttribute("data-type");TTD.Views.Dashboard.$main.$el.find(".".concat(t,"-container")).toggle(e.currentTarget.checked)},updateCounters:function(){this.$(".single-templates .templates-counter").html(TTD.Views.Dashboard.$main.$singleTemplatesView.$el.children().length),this.$(".list-templates .templates-counter").html(TTD.Views.Dashboard.$main.$listTemplatesView.$el.children().length)}})},"typography.js":function(e,t,i){var s,n,a;s=jQuery,n=i("../modals/typography/item-views/import_preview"),a=i("../modals/typography/export"),t.exports=i("../base").extend({template:"dashboard/sidebar/typography",after_initialize:function(){TTD.objects.modals.typography_import_preview_modal=new n({type:"small"}),TTD.objects.modals.typography_export_modal=new a({type:"small"})},factory_reset:function(){s.ajax({url:TTD.CONST.routes.templates+"/factory_reset",type:"POST",headers:{"X-WP-Nonce":TTD.CONST.nonce}}).done(function(){return TTD.utils.message("All templates have been reset to default!","success",5e3)}).error(function(){return TTD.utils.message("Error resetting all templates!","error",5e3)})},import:function(){TTD.objects.modals.typography_import_preview_modal.open()},export:function(){TTD.objects.modals.typography_export_modal.open()}})},wizard:{"main.js":function(e,t,i){var s;s=jQuery,t.exports=i("../../base").extend({template:"dashboard/sidebar/wizard",stepTemplate:"dashboard/sidebar/wizard/steps",$dom:{},before_initialize:function(e){e.model=this.model=i("../../../models/wizard")},after_initialize:function(){var t=this;this.$dom={},this.model.sections.forEach(function(e){return t.$dom[e.id]=t.$("#wizard-section-".concat(e.id))}),this.renderSteps(),this.model.on("change",this.renderSteps.bind(this))},toggleCollapse:function(e,t){t.closest(".collapsible").classList.toggle("collapse"),s(t).next(".section-steps").slideToggle(200)},renderSteps:function(){var i=this,s=1,n=TTD.utils.tpl(this.stepTemplate);this.model.sections.forEach(function(e){var t=i.model.getSteps(e.id);i.$dom[e.id].html(n({view:i,steps:t,baseIndex:s})),s+=t.length})},stepClick:function(e){this.model.gotoStep(e.currentTarget.dataset.step),TTD.objects.wizardView.hideTooltip()},restart:function(){return this.model.isNew=function(){return!1},s("body").addClass("ttd-loading"),this.model.destroy().then(function(){return location.reload()}),!1}})}}},skins:{"create.js":function(e,t,i){var s;jQuery,s=i("../base"),t.exports=s.extend({className:"create-skin-btn-container",template:"dashboard/sidebar/skins/create",open_skin_create_modal:function(){TTD.objects.modals.new_skin.open({collection:TTD.objects.collections.skins})}})},"item.js":function(e,t,i){var s,n,a,o,r,l;s=jQuery,n=i("../base"),a=i("../../models/skin"),o=i("../modals/skins/export"),r=i("../preview/preview"),l=!1,t.exports=n.extend({tagName:"div",className:"ttd-skin-item-container",template:"dashboard/sidebar/skins/item",after_render:function(){this.$skin_name=this.$(".ttd-skin-item-name"),this.$dropdown=this.$(".ttd-skin-item-dropdown"),this.$justAdded=this.$(".ttd-added-mark"),this.show_just_added()},show_just_added:function(){(this.model.isNew()||this.model.get("is_duplicate")||this.model.get("is_imported"))&&(this.$justAdded.css("opacity",1),this.el.classList.add("tooltip-visible"),this.model.set(this.model.idAttribute,this.model.get("id")),this.model.set({is_duplicate:0,is_imported:0}))},make_active:function(){this.model.make_active()},toggle_dropdown_actions:function(e){s(".ttd-skin-item-dropdown.visible").removeClass("visible"),this.$dropdown.toggleClass("visible")},export_skin:function(){TTD.objects.modals.skin_export_modal=new o({type:"small",ID:this.model.get("term_id")}),TTD.objects.modals.skin_export_modal.open()},duplicate_skin:function(){var s=this,e=new a({name:this.get_unique_name(this.model)});TTD.utils.loading(),e.save({source_skin_id:this.model.get("term_id")},{wait:!0,success:function(e){e.set("is_duplicate",1),s.model.collection.add(e,{at:0}),TTD.utils.message("Theme <b>duplicated</b> successfully!","success"),TTD.Elements.$body.removeClass("ttd-loading")},error:function(e,t,i){s.error(e,t,i)}})},get_unique_name:function(e){for(var t="Copy of "+e.get("name"),i=1,s=this.model.collection.where({name:t});s.length;)t=-1!==t.indexOf(i-1)?t.replace(i-1,i):t+"_"+i,s=this.model.collection.where({name:t}),i+=1;return t},edit_name:function(){this.$(".ttd-skin-item-dropdown").removeClass("visible"),0===this.$skin_name.find("input").length&&this.$skin_name.html('<input class="keydown blur" type="text" data-fn="save_name" value="'+this.model.get("name")+'">').find("input").focus(),this.$el.addClass("name-edit-mode")},save_name:function(e){var s=this;if("keydown"!==e.type||(l=27===e.keyCode,13===e.keyCode))if(this.$el.removeClass("name-edit-mode"),l)l=!1;else{var t=this.$skin_name.find("input").val().trim();t!==this.model.get("name")?t&&0!==t.length&&(this.model.collection.where({name:t}).length?TTD.utils.message("A theme with the name provided already exists","error"):this.model.save({name:t},{wait:!0,success:function(){s.render(),TTD.Views.Dashboard.render_theme_info(1),TTD.utils.message("Name <b>changed</b> successfully!")},error:function(e,t,i){return s.error(e,t,i)}})):this.render()}else 27===e.keyCode&&this.render()},delete_skin:function(){TTD.objects.modals.delete_skin.open({model:this.model}),this.$dropdown.toggleClass("visible")},open_preview:function(e,t){var i=t.getAttribute("data-url");TTD.Elements.$body.addClass("ttd-loading ttd-in-preview "),TTD.Views.Preview&&TTD.Views.Preview.undelegateEvents(),TTD.Views.Preview=new r({el:s(".ttd-preview-container")[0],model:this.model.set("preview_open",1),url:i})},hideNew:function(e){var t=this;!e.target.classList.contains("ttd-theme-added")&&parseInt(this.$justAdded.css("opacity"))&&setTimeout(function(){t.$justAdded.css("opacity",0),t.el.classList.remove("tooltip-visible")},3e3)}})},"list.js":function(e,t,i){var s,n,a,o,r,l;s=jQuery,n=i("../base"),a=i("./item"),o=i("../../collections/skins"),r=i("./create"),l=i("../modals/skins/delete"),t.exports=n.extend({className:"ttd-skins-listing",template:"dashboard/sidebar/skins/list",after_render:function(){this.init_skin_collection(),this.render_create_button(),TTD.utils.init_scrollbar(this.$(".ttd-skin-scroll"))},init_skin_collection:function(){TTD.objects.modals.delete_skin=new l({type:"small"}),void 0===TTD.objects.collections.skins&&(TTD.objects.collections.skins=new o(TTD.CONST.skins)),this.collection=TTD.objects.collections.skins,this.listenTo(this.collection,"sort",this.render_list.bind(this)),this.listenTo(this.collection,"add",this.render_list.bind(this)),this.listenTo(this.collection,"destroy",this.render_list.bind(this)),this.collection.sort()},render_list:function(){var i=this.$(".ttd-skins-list").empty();this.collection.each(function(e){if(!e.is_active()&&"default"!==e.get("tag")){var t=new a({model:e});i.append(t.$el)}})},render_create_button:function(){this.$createView=new r,this.$createView.$el.insertBefore(this.$(".ttd-skins-list-container"))},toggle_list_dropdown:function(e){s(e.currentTarget).hasClass("ttd-rotate")?this.$(".scroll-content").css("overflow-x",""):this.$(".scroll-content").css("overflow-x","hidden"),s(e.currentTarget).toggleClass("ttd-rotate"),this.$(".ttd-skins-list").toggle()}})},"main.js":function(e,t,i){var s,n,a,o,r;s=jQuery,n=i("../base"),a=i("./list"),o=i("./item"),r=i("../modals/skins/create"),t.exports=n.extend({template:"dashboard/sidebar/skins/main",after_render:function(){var t=this;this.render_skins_list(),this.render_active_skin(),TTD.objects.modals.new_skin=new r,TTD.utils.add_action("theme.document.click",function(e){e.target.classList.contains("ttd-skin-item-dots")||e.target.parentElement&&e.target.parentElement.classList.contains("ttd-skin-item-dots")||s(".ttd-skin-item-dropdown.visible").removeClass("visible")}),TTD.utils.add_action("theme.document.keyup",function(e){27===e.keyCode&&t.$el.hasClass("ttd-anim-down")&&s(".ttd-ss").click()})},render_active_skin:function(){this.$active_skin_view=new o({model:TTD.objects.collections.skins.get_active_skin()}),this.$(".ttd-active-skin-container").append(this.$active_skin_view.$el)},render_skins_list:function(){this.$skin_view=new a,this.$(".ttd-skins-view-content").append(this.$skin_view.$el)}})}},"theme-info.js":function(e,t,i){jQuery,t.exports=i("./base").extend({template:"dashboard/theme-info",className:"ttd-theme-info",after_initialize:function(e){this.$skinsView=e.skinsView,this.$iconsView=e.iconsView},after_render:function(e){e.is_collapsed&&(this.$el.addClass("ttd-change-bg"),this.$el.find("h1 span").html("Currently Editing Theme:"))},toggle_skin_view:function(){var e=this;this.is_visible()?(this.$iconsView.$el.find(".ttd-icon-blue").removeClass("ttd-change-bg").addClass("ttd-change-bg-reverse"),this.$skinsView.$el.removeClass("ttd-anim-down").addClass("ttd-anim-up"),setTimeout(function(){e.$skinsView.hide()},150),this.$el.removeClass("ttd-change-bg"),this.$el.find("h1 span").html("Current Theme:")):(this.$iconsView.$el.find(".ttd-icon-blue").removeClass("ttd-change-bg-reverse").addClass("ttd-change-bg"),this.$skinsView.$el.show().addClass("ttd-anim-down").removeClass("ttd-anim-up"),this.$el.addClass("ttd-change-bg"),this.$el.find("h1 span").html("Currently Editing Theme:"));var t=this.$skinsView.$(".ttd-skin-item-dropdown").last();TTD.utils.is_in_viewport(t[0])||t.addClass("visible-up")},is_visible:function(){return this.$el.hasClass("ttd-change-bg")}})}}}}}}}})("workspace/inc/assets/js/admin/router");